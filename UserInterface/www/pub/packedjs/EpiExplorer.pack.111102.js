function numberWithCommas(a){return a.toString().replace(/\B(?=(?:\d{3})+(?!\d))/g,",")}String.prototype.startsWith=function(a){return this.match("^"+a)==a};Array.prototype.sum=function(a,b){return!this.length?0:this.slice(1).sum(a-1,b-1)+(typeof this[0]=="number"&a<=0&b>=0?this[0]:0)};Array.prototype.binarySearchLE=function(a){for(var b=0,c=this.length-1,e,f;b<=c;)e=Math.floor((b+c)/2),(f=this[e]<=a)?b=e+1:c=e-1;return c};
Array.prototype.searchSE=function(a){for(;a>=0;a--)if(this[a]!==void 0)return a;return 0};Array.prototype.searchLE=function(a){for(;a<this.length;a++)if(this[a]!==void 0)return a;return this.length-1};if(typeof String.prototype.trim==="undefined")String.prototype.trim=function(){return String(this).replace(/^\s+|\s+$/g,"")};String.prototype.repeat=function(a){return Array(a+1).join(this)};
if(!Object.keys)Object.keys=function(a){if(a!==Object(a))throw new TypeError("Object.keys called on non-object");var b=[],c;for(c in a)Object.prototype.hasOwnProperty.call(a,c)&&b.push(c);return b};function getDefaultReferenceState(){return{genome:"",dataset:"",query:"",queryParts:[],editable:false,values:{},totalNumber:0}}function getParameterByName(a){return(a=RegExp("[?&]"+a+"=([^&]*)").exec(window.location.search))&&decodeURIComponent(a[1].replace(/\+/g," "))}
function emailvalidate(a){return/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/.test(a)==false?false:true}function convertRangeToNumber(a,b,c){return a<Math.pow(10,b-1)?a:(a=a.toString(),c=Math.pow(10,a[0]-c-b+2),b>1&&a[1]=="0"&&(a=a[0]+"1",b>2&&(a+="0")),b=parseInt(a.slice(1),10),b==0?c:b*c)}function convertRatioToNumber(a,b){return a/Math.pow(10,b)}
function highlightElement(a,b,c){var e=a.css("background-color");a.css("background-color","#ffffc8").show("pulsate",{times:c},b,function(){a.css("background-color",e)})}
function initBasicButtons(){$("body").delegate(".notimplementedButton","click",function(){alert("This functionality is not yet implemented!")});$("#exploreDefaultDatasetsLink").click(function(){window.location.href="index.php"});$("#exploreII27Button").click(function(){window.location.href="exploreII27.php"});$("#uploadUserDatasetsButton").click(function(){window.location.href="uploadManagement.php"});$("#searchButton").click(function(){window.location.href="search.php"});$("#aboutButton").click(function(){window.location.href=
"about.php"});$("#giveFeedbackButton").click(function(){window.location.href="feedback.php"})};function readableOverlaps(a,b){return"The region overlaps with "+a+b}function readableMethRatio(a,b,c,e){var f=e.split("--");if(f.length==2)return e=f[0].split(":"),f=f[1].split(":"),"The "+a+" methylation ratio in "+b+" is between "+(parseInt(e[c],10)+1)/100+" and "+(parseInt(f[c],10)+1)/100;else if(f.length==1)return e=f[0].split(":"),"The "+a+" methylation ratio in "+b+" is "+(parseInt(e[c],10)+1)/100}
function readableOverlapRatio(a,b,c){var e=c.split("--");if(e.length==2)return c=e[0].split(":"),e=e[1].split(":"),"Between "+(parseInt(c[b],10)+1)+"% and "+(parseInt(e[b],10)+1)+"% of the region overlap with "+a;else if(e.length==1)return c=e[0].split(":"),parseInt(c[b],10)+1+"% of the region overlap with "+a}function readableNOTOverlaps(a,b){return"The region DOES NOT overlap with "+a+b}
function readableDistanceTo(a,b,c,e,f,d){var g=e.split("--");if(g.length==2)return e=g[0].split(":"),g=g[1].split(":"),"The minimum distance to "+a+" "+b+" is between "+convertRangeToNumber(parseInt(e[c],10),f,d)+" and "+convertRangeToNumber(parseInt(g[c],10)+1,f,d)+" bp";else if(g.length==1)return e=g[0].split(":"),"The minimum distance to "+a+" "+b+" is between "+convertRangeToNumber(parseInt(e[c],10),f,d)+" and "+convertRangeToNumber(parseInt(e[c],10)+1,f,d)+" bp"}
var overlapLabels={"Eoverlaps:repeats:any":"Any repeats","Eoverlaps:repeats:DNA":"DNA","Eoverlaps:repeats:snRNA":"snRNA","Eoverlaps:repeats:Low_complexity":"Low complexity","Eoverlaps:repeats:LINE":"LINE","Eoverlaps:repeats:SINE":"SINE","Eoverlaps:repeats:Simple_repeat":"Simple repeats","Eoverlaps:repeats:srpRNA":"srpRNA","Eoverlaps:repeats:scRNA":"scRNA","Eoverlaps:repeats:LTR":"LTR","Eoverlaps:repeats:RC":"RC","Eoverlaps:repeats:rRNA":"rRNA","Eoverlaps:repeats:RNA":"RNA","Eoverlaps:repeats:tRNA":"tRNA",
"Eoverlaps:repeats:Satellite":"Satellite","Eoverlaps:repeats:Other":"Other","Eoverlaps:repeats:Unknown":"Unknown","Eoverlaps:cons":"Conserved regions","Eoverlaps:genes":"Genes","Eoverlaps:exons":"Exons","Eoverlaps:introns":"Introns","Eoverlaps:promoters_def":"Gene promoters (-5kb to 1kb)","Eoverlaps:promoters_cen":"Gene promoters (-1kb to 1kb)","Eoverlaps:promoters_reg":"Gene promoters (-10kb to 2kb)","Eoverlaps:promoters_TSS":"Gene transcription start sites","Eoverlaps:ucscCGI":"CpG islands (specific)",
"Eoverlaps:DNaseI:any":"DNaseI sites (any)","Eoverlaps:DNaseI:GM12878":"DNaseI sites (GM12878)","Eoverlaps:DNaseI:H1hESC":"DNaseI sites (H1-hESC)","Eoverlaps:DNaseI:HepG2":"DNaseI sites (HepG2)","Eoverlaps:DNaseI:NHLF":"DNaseI sites (NHLF)","Eoverlaps:DNaseI:HUVEC":"DNaseI sites (HUVEC)","Eoverlaps:DNaseI:NHEK":"DNaseI sites (NHEK)","Eoverlaps:DNaseI:K562":"DNaseI sites (K562)","Eoverlaps:DNaseI:HeLaS3":"DNaseI sites (Helas3)","Eoverlaps:DNaseI:HMEC":"DNaseI sites (HMEC)"},bhist={CTCF:"GM12878,H1hESC,HepG2,HMEC,HSMM,HUVEC,K562,NHEK,NHLF,any".split(","),
H3K4me1:"GM12878,H1hESC,HMEC,HSMM,HUVEC,K562,NHEK,NHLF,any".split(","),H3K4me2:"GM12878,H1hESC,HepG2,HMEC,HSMM,HUVEC,K562,NHEK,NHLF,any".split(","),H3K4me3:"GM12878,H1hESC,HepG2,HMEC,HSMM,HUVEC,K562,NHEK,NHLF,any".split(","),H3K9ac:"GM12878,H1hESC,HepG2,HMEC,HSMM,HUVEC,K562,NHEK,NHLF,any".split(","),H3K9me1:["HUVEC","K562","NHEK","any"],H3K27ac:"GM12878,HepG2,HMEC,HSMM,HUVEC,K562,NHEK,NHLF,any".split(","),H3K27me3:"GM12878,H1hESC,HMEC,HSMM,HUVEC,K562,NHEK,NHLF,any".split(","),H4K20me1:"GM12878,H1hESC,HepG2,HMEC,HSMM,HUVEC,K562,NHEK,NHLF,any".split(","),
H3K36me3:"GM12878,H1hESC,HepG2,HMEC,HSMM,HUVEC,K562,NHEK,NHLF,any".split(","),Pol2b:["HUVEC","K562","NHEK","any"]};$.each(bhist,function(a,b){$.each(b,function(b,e){overlapLabels["Eoverlaps:bhist:"+a+":"+e]=e=="any"?a+" (any tissue)":a+" ("+e+")"})});
var chmm={chmm01aprom:"GM12878,H1hESC,HepG2,HMEC,HSMM,HUVEC,K562,NHEK,NHLF,any".split(","),chmm02wprom:"GM12878,H1hESC,HepG2,HMEC,HSMM,HUVEC,K562,NHEK,NHLF,any".split(","),chmm03pprom:"GM12878,H1hESC,HepG2,HMEC,HSMM,HUVEC,K562,NHEK,NHLF,any".split(","),chmm04strenh:"GM12878,H1hESC,HepG2,HMEC,HSMM,HUVEC,K562,NHEK,NHLF,any".split(","),chmm05strenh:"GM12878,H1hESC,HepG2,HMEC,HSMM,HUVEC,K562,NHEK,NHLF,any".split(","),chmm06wenh:"GM12878,H1hESC,HepG2,HMEC,HSMM,HUVEC,K562,NHEK,NHLF,any".split(","),chmm07wenh:"GM12878,H1hESC,HepG2,HMEC,HSMM,HUVEC,K562,NHEK,NHLF,any".split(","),
chmm08ins:"GM12878,H1hESC,HepG2,HMEC,HSMM,HUVEC,K562,NHEK,NHLF,any".split(","),chmm09trtr:"GM12878,H1hESC,HepG2,HMEC,HSMM,HUVEC,K562,NHEK,NHLF,any".split(","),chmm10trel:"GM12878,H1hESC,HepG2,HMEC,HSMM,HUVEC,K562,NHEK,NHLF,any".split(","),chmm11wtrx:"GM12878,H1hESC,HepG2,HMEC,HSMM,HUVEC,K562,NHEK,NHLF,any".split(","),chmm12prepr:"GM12878,H1hESC,HepG2,HMEC,HSMM,HUVEC,K562,NHEK,NHLF,any".split(","),chmm13hetr:"GM12878,H1hESC,HepG2,HMEC,HSMM,HUVEC,K562,NHEK,NHLF,any".split(","),chmm14rcnv:"GM12878,H1hESC,HepG2,HMEC,HSMM,HUVEC,K562,NHEK,NHLF,any".split(","),
chmm15rcnv:"GM12878,H1hESC,HepG2,HMEC,HSMM,HUVEC,K562,NHEK,NHLF,any".split(",")};$.each(chmm,function(a,b){$.each(b,function(b,e){var f=getTextForFeatureGroup(a);overlapLabels["Eoverlaps:"+a+":"+e]=e=="any"?f+" (any tissue)":f+" ("+e+")"})});
for(var rrbsMethTissues="hES_H1_p38,hES_H9_p58,hFib_11_p8,hEB16d_H1_p38,fetal_heart,Fetal_kidney,Fetal_lung,Fetal_brain,Smooth_muscle,Skeletal_muscle,Stomach_mucosa,Neuron_H9_derived,NPC_H9_derived,Human_blood_CD34_mobilized_REMC".split(","),rrbsMethTissueIndex=0;rrbsMethTissueIndex<rrbsMethTissues.length;rrbsMethTissueIndex++)if(rrbsMethTissues[rrbsMethTissueIndex]!=void 0){var rrbsMethTissue=rrbsMethTissues[rrbsMethTissueIndex],newk="Eoverlaps:rrbs:"+rrbsMethTissue+":unmeth";overlapLabels[newk]=
"Unmethylated in "+rrbsMethTissue.replace(/_/g," ");newk="Eoverlaps:rrbs:"+rrbsMethTissue+":meth";overlapLabels[newk]="Methylated in "+rrbsMethTissue.replace(/_/g," ")}for(var overlapLabel in overlapLabels){var newOverlapLabel=overlapLabel.replace("Eoverlaps:","Eoverlaps10p:");overlapLabels[newOverlapLabel]=overlapLabels[overlapLabel];newOverlapLabel=overlapLabel.replace("Eoverlaps:","Eoverlaps50p:");overlapLabels[newOverlapLabel]=overlapLabels[overlapLabel]}
function getReadableFeatureText(a){if(a.startsWith("Echr:chr"))return"Chromosome "+a.substr(8);else if(a.startsWith("Elength_magnitude:")){var b=a.split("--");if(b.length==2)return"Length of the region is between "+convertRangeToNumber(parseInt(b[0].substr(18),10),3,0)+" and "+convertRangeToNumber(1+parseInt(b[1].substr(18),10),3,0);else if(b.length==1)return"Length of the region is between "+convertRangeToNumber(parseInt(b[0].substr(18),10),3,0)+" and "+convertRangeToNumber(1+parseInt(b[0].substr(18),
10),3,0)}else if(a.startsWith("Ednaseq:"))if(b=a.split("--"),b.length==2)return a=b[0].split(":"),b=b[1].split(":"),"The frequency of the "+a[1]+" pattern is between "+a[3]/1E3+" and "+b[3]/1E3;else{if(b.length==1)return b=b[0].split(":"),"The frequency of the "+b[1]+" pattern is "+b[3]/1E3}else if(a.startsWith("Eoverlaps:repeats:"))return readableOverlaps(a.substr(18)+" repeats","(1bp)");else if(a.startsWith("Eoverlaps10p:repeats:"))return readableOverlaps(a.substr(21)+" repeats","(10%)");else if(a.startsWith("Eoverlaps50p:repeats:"))return readableOverlaps(a.substr(21)+
" repeats","(50%)");else if(a.startsWith("-Eoverlaps:repeats:"))return readableNOTOverlaps(a.substr(19)+" repeats","(1bp)");else if(a.startsWith("-Eoverlaps10p:repeats:"))return readableNOTOverlaps(a.substr(22)+" repeats","(10%)");else if(a.startsWith("-Eoverlaps50p:repeats:"))return readableNOTOverlaps(a.substr(22)+" repeats","(50%)");else if(a.startsWith("Eor:repeats:"))return readableOverlapRatio(a.split("--")[0].split(":")[2]+" repeats",3,a);else if(a.startsWith("Eoverlaps:DNaseI:"))return readableOverlaps("DNaseI hypersensitive sites in "+
a.substr(17)+" tissue","(1bp)");else if(a.startsWith("Eoverlaps10p:DNaseI:"))return readableOverlaps("DNaseI hypersensitive sites in "+a.substr(20)+" tissue","(10%)");else if(a.startsWith("Eoverlaps50p:DNaseI:"))return readableOverlaps("DNaseI hypersensitive sites in "+a.substr(20)+" tissue","(50%)");else if(a.startsWith("Eor:DNaseI:"))return readableOverlapRatio("DNaseI hypersensitive sites in "+a.split("--")[0].split(":")[2]+" tissue",3,a);else if(a.startsWith("-Eoverlaps:DNaseI:"))return readableNOTOverlaps("DNaseI hypersensitive sites in "+
a.substr(18)+" tissue","(1bp)");else if(a.startsWith("-Eoverlaps10p:DNaseI:"))return readableNOTOverlaps("DNaseI hypersensitive sites in "+a.substr(21)+" tissue","(10%)");else if(a.startsWith("-Eoverlaps50p:DNaseI:"))return readableNOTOverlaps("DNaseI hypersensitive sites in "+a.substr(21)+" tissue","(50%)");else if(a.startsWith("Emdd:DNaseI:"))return readableDistanceTo("a DNaseI hypersensitive site","downstream",3,a,2,0);else if(a.startsWith("Emud:DNaseI:"))return readableDistanceTo("a DNaseI hypersensitive site",
"upstream",3,a,2,0);else if(a.startsWith("Emmd:DNaseI:"))return b=a.split("--")[0].split(":"),readableDistanceTo("a "+b[2]+" DNaseI hypersensitive site","",3,a,2,0);else if(a.startsWith("Eoverlaps:chmm"))return b=a.split("--")[0].split(":"),readableOverlaps(getTextForFeatureGroup(b[1])+" in "+b[2]+" tissue","(1bp)");else if(a.startsWith("Eoverlaps10p:chmm"))return b=a.split("--")[0].split(":"),readableOverlaps(getTextForFeatureGroup(b[1])+" in "+b[2]+" tissue","(10%)");else if(a.startsWith("Eoverlaps50p:chmm"))return b=
a.split("--")[0].split(":"),readableOverlaps(getTextForFeatureGroup(b[1])+" in "+b[2]+" tissue","(50%)");else if(a.startsWith("Eor:chmm"))return b=a.split("--")[0].split(":"),readableOverlapRatio(getTextForFeatureGroup(b[1])+" in "+b[2]+" tissue",3,a);else if(a.startsWith("-Eoverlaps:chmm"))return b=a.split("--")[0].split(":"),readableNOTOverlaps(getTextForFeatureGroup(b[1])+" in "+b[2]+" tissue","(1bp)");else if(a.startsWith("-Eoverlaps10p:chmm"))return b=a.split("--")[0].split(":"),readableNOTOverlaps(getTextForFeatureGroup(b[1])+
" in "+b[2]+" tissue","(10%)");else if(a.startsWith("-Eoverlaps50p:chmm"))return b=a.split("--")[0].split(":"),readableNOTOverlaps(getTextForFeatureGroup(b[1])+" in "+b[2]+" tissue","(50%)");else if(a.startsWith("Emmd:chmm"))return b=a.split("--")[0].split(":"),readableDistanceTo("a "+b[2]+" "+getTextForFeatureGroup(b[1])+" site","",3,a,2,0);else if(a.startsWith("Eoverlaps:cgihunterCGI"))return readableOverlaps("CGIHunter CpG islands","(1bp)");else if(a.startsWith("Eoverlaps10p:cgihunterCGI","(10%)"))return readableOverlaps("CGIHunter CpG islands");
else if(a.startsWith("Eoverlaps50p:cgihunterCGI"))return readableOverlaps("CGIHunter CpG islands","(50%)");else if(a.startsWith("Eor:cgihunterCGI:"))return readableOverlapRatio("CGIHunter CpG islands",2,a);else if(a.startsWith("-Eoverlaps:cgihunterCGI"))return readableNOTOverlaps("CGIHunter CpG islands","(1bp)");else if(a.startsWith("-Eoverlaps10p:cgihunterCGI"))return readableNOTOverlaps("CGIHunter CpG islands","(10%)");else if(a.startsWith("-Eoverlaps50p:cgihunterCGI"))return readableNOTOverlaps("CGIHunter CpG islands",
"(50%)");else if(a.startsWith("Emdd:cgihunterCGI:"))return readableDistanceTo("a CGIHunter CGI","downstream",2,a,2,0);else if(a.startsWith("Emud:cgihunterCGI:"))return readableDistanceTo("a CGIHunter CGI","upstream",2,a,2,0);else if(a.startsWith("Emmd:cgihunterCGI:"))return readableDistanceTo("a CGIHunter CGI","",2,a,2,0);else if(a.startsWith("Eoverlaps:ucscCGI"))return readableOverlaps("CpG islands","(1bp)");else if(a.startsWith("Eoverlaps10p:ucscCGI"))return readableOverlaps("CpG islands","(10%)");
else if(a.startsWith("Eoverlaps50p:ucscCGI"))return readableOverlaps("CpG islands","(50%)");else if(a.startsWith("Eor:ucscCGI:"))return readableOverlapRatio("CpG islands",2,a);else if(a.startsWith("-Eoverlaps:ucscCGI"))return readableNOTOverlaps("CpG islands","(1bp)");else if(a.startsWith("-Eoverlaps10p:ucscCGI"))return readableNOTOverlaps("CpG islands","(10%)");else if(a.startsWith("-Eoverlaps50p:ucscCGI"))return readableNOTOverlaps("CpG islands","(50%)");else if(a.startsWith("Emdd:ucscCGI:"))return readableDistanceTo("a UCSC CGI",
"downstream",2,a,2,0);else if(a.startsWith("Emud:ucscCGI:"))return readableDistanceTo("a UCSC CGI","upstream",2,a,2,0);else if(a.startsWith("Emmd:ucscCGI:"))return readableDistanceTo("a UCSC CGI","",2,a,2,0);else if(a.startsWith("Eoverlaps:cons"))return readableOverlaps("conserved regions","(1bp)");else if(a.startsWith("Eoverlaps10p:cons"))return readableOverlaps("conserved regions","(10%)");else if(a.startsWith("Eoverlaps50p:cons"))return readableOverlaps("conserved regions","(50%)");else if(a.startsWith("Eor:cons:"))return readableOverlapRatio("conserved regions",
2,a);else if(a.startsWith("-Eoverlaps:cons"))return readableNOTOverlaps("conserved regions","(1bp)");else if(a.startsWith("-Eoverlaps10p:cons"))return readableNOTOverlaps("conserved regions","(10%)");else if(a.startsWith("-Eoverlaps50p:cons"))return readableNOTOverlaps("conserved regions","(50%)");else if(a.startsWith("Emdd:cons:"))return readableDistanceTo("conserved regions","downstream",2,a,2,0);else if(a.startsWith("Emud:cons:"))return readableDistanceTo("conserved regions","upstream",2,a,2,0);
else if(a.startsWith("Emmd:cons:"))return readableDistanceTo("conserved regions","",2,a,2,0);else if(a.startsWith("Eoverlaps:genes"))return readableOverlaps("genes","(1bp)");else if(a.startsWith("Eoverlaps10p:genes"))return readableOverlaps("genes","(10%)");else if(a.startsWith("Eoverlaps50p:genes"))return readableOverlaps("genes","(50%)");else if(a.startsWith("Eor:genes:"))return readableOverlapRatio("genes",2,a);else if(a.startsWith("-Eoverlaps:genes"))return readableNOTOverlaps("genes","(1bp)");
else if(a.startsWith("-Eoverlaps10p:genes"))return readableNOTOverlaps("genes","(10%)");else if(a.startsWith("-Eoverlaps50p:genes"))return readableNOTOverlaps("genes","(50%)");else if(a.startsWith("Emdd:genes:"))return readableDistanceTo("genes","downstream",2,a,2,0);else if(a.startsWith("Emud:genes:"))return readableDistanceTo("genes","upstream",2,a,2,0);else if(a.startsWith("Emmd:genes:"))return readableDistanceTo("genes","",2,a,2,0);else if(a=="Eoverlaps:promoters_def")return readableOverlaps("gene promoters (-5kb->1kb)",
"(1bp)");else if(a=="Eoverlaps10p:promoters_def")return readableOverlaps("gene promoters (-5kb->1kb)","(10%)");else if(a=="Eoverlaps50p:promoters_def")return readableOverlaps("gene promoters (-5kb->1kb)","(50%)");else if(a.startsWith("Eor:promoters_def:"))return readableOverlapRatio("gene promoters (-5kb->1kb)",2,a);else if(a.startsWith("-Eoverlaps:promoters_def"))return readableNOTOverlaps("gene promoters (-5kb->1kb)","(1bp)");else if(a.startsWith("-Eoverlaps10p:promoters_def"))return readableNOTOverlaps("gene promoters (-5kb->1kb)",
"(10%)");else if(a.startsWith("-Eoverlaps50p:promoters_def"))return readableNOTOverlaps("gene promoters (-5kb->1kb)","(50%)");else if(a.startsWith("Emdd:promoters_def:"))return readableDistanceTo("gene promoters (-5kb->1kb)","downstream",2,a,2,0);else if(a.startsWith("Emud:promoters_def:"))return readableDistanceTo("gene promoters (-5kb->1kb)","upstream",2,a,2,0);else if(a.startsWith("Emmd:promoters_def:"))return readableDistanceTo("gene promoters (-5kb->1kb)","",2,a,2,0);else if(a.startsWith("Eoverlaps:promoters_cen"))return readableOverlaps("gene promoters (-1kb->1kb)",
"(1bp)");else if(a.startsWith("Eoverlaps10p:promoters_cen"))return readableOverlaps("gene promoters (-1kb->1kb)","(10%)");else if(a.startsWith("Eoverlaps50p:promoters_cen"))return readableOverlaps("gene promoters (-1kb->1kb)","(50%)");else if(a.startsWith("Eor:promoters_cen:"))return readableOverlapRatio("gene promoters (-1kb->1kb)",2,a);else if(a.startsWith("-Eoverlaps:promoters_cen"))return readableNOTOverlaps("gene promoters (-1kb->1kb)","(1bp)");else if(a.startsWith("-Eoverlaps10p:promoters_cen"))return readableNOTOverlaps("gene promoters (-1kb->1kb)",
"(10%)");else if(a.startsWith("-Eoverlaps50p:promoters_cen"))return readableNOTOverlaps("gene promoters (-1kb->1kb)","(50%)");else if(a.startsWith("Emdd:promoters_cen:"))return readableDistanceTo("gene promoters (-1kb->1kb)","downstream",2,a,2,0);else if(a.startsWith("Emud:promoters_cen:"))return readableDistanceTo("gene promoters (-1kb->1kb)","upstream",2,a,2,0);else if(a.startsWith("Emmd:promoters_cen:"))return readableDistanceTo("gene promoters (-1kb->1kb)","",2,a,2,0);else if(a.startsWith("Eoverlaps:promoters_reg"))return readableOverlaps("gene promoters (-10kb->2kb)",
"(1bp)");else if(a.startsWith("Eoverlaps10p:promoters_reg"))return readableOverlaps("gene promoters (-10kb->2kb)","(10%)");else if(a.startsWith("Eoverlaps50p:promoters_reg"))return readableOverlaps("gene promoters (-10kb->2kb)","(50%)");else if(a.startsWith("Eor:promoters_reg:"))return readableOverlapRatio("gene promoters (-10kb->2kb)",2,a);else if(a.startsWith("-Eoverlaps:promoters_reg"))return readableNOTOverlaps("gene promoters (-10kb->2kb)","(1bp)");else if(a.startsWith("-Eoverlaps10p:promoters_reg"))return readableNOTOverlaps("gene promoters (-10kb->2kb)",
"(10%)");else if(a.startsWith("-Eoverlaps50p:promoters_reg"))return readableNOTOverlaps("gene promoters (-10kb->2kb)","(50%)");else if(a.startsWith("Emdd:promoters_reg:"))return readableDistanceTo("gene promoters (-10kb->2kb)","downstream",2,a,2,0);else if(a.startsWith("Emud:promoters_reg:"))return readableDistanceTo("gene promoters (-10kb->2kb)","upstream",2,a,2,0);else if(a.startsWith("Emmd:promoters_reg:"))return readableDistanceTo("gene promoters (-10kb->2kb)","",2,a,2,0);else if(a.startsWith("Eoverlaps:exons"))return readableOverlaps("gene exons",
"(1bp)");else if(a.startsWith("Eoverlaps10p:exons"))return readableOverlaps("gene exons","(10%)");else if(a.startsWith("Eoverlaps50p:exons"))return readableOverlaps("gene exons","(50%)");else if(a.startsWith("Eor:exons:"))return readableOverlapRatio("gene exons",2,a);else if(a.startsWith("-Eoverlaps:exons"))return readableNOTOverlaps("gene exons","(1bp)");else if(a.startsWith("-Eoverlaps10p:exons"))return readableNOTOverlaps("gene exons","(10%)");else if(a.startsWith("-Eoverlaps50p:exons"))return readableNOTOverlaps("gene exons",
"(50%)");else if(a.startsWith("Emdd:exons:"))return readableDistanceTo("gene exons","downstream",2,a,2,0);else if(a.startsWith("Emud:exons:"))return readableDistanceTo("gene exons","upstream",2,a,2,0);else if(a.startsWith("Emmd:exons:"))return readableDistanceTo("gene exons","",2,a,2,0);else if(a.startsWith("Eoverlaps:introns"))return readableOverlaps("gene introns","(1bp)");else if(a.startsWith("Eor:introns:"))return readableOverlapRatio("gene introns",2,a);else if(a.startsWith("-Eoverlaps:introns"))return readableNOTOverlaps("gene introns",
"(1bp)");else if(a.startsWith("-Eoverlaps10p:introns"))return readableNOTOverlaps("gene introns","(10%)");else if(a.startsWith("-Eoverlaps50p:introns"))return readableNOTOverlaps("gene introns","(50%)");else if(a.startsWith("Emdd:introns:"))return readableDistanceTo("gene introns","downstream",2,a,2,0);else if(a.startsWith("Emud:introns:"))return readableDistanceTo("gene introns","upstream",2,a,2,0);else if(a.startsWith("Emmd:introns:"))return readableDistanceTo("gene introns","",2,a,2,0);else if(a.startsWith("Eoverlaps:promoters_TSS"))return readableOverlaps("gene TSS",
"(1bp)");else if(a.startsWith("Eoverlaps10p:promoters_TSS"))return readableOverlaps("gene TSS","(10%)");else if(a.startsWith("Eoverlaps50p:promoters_TSS"))return readableOverlaps("gene TSS","(50%)");else if(a.startsWith("Eor:promoters_TSS:"))return readableOverlapRatio("gene TSS",2,a);else if(a.startsWith("-Eoverlaps:promoters_TSS"))return readableNOTOverlaps("gene TSS","(1bp)");else if(a.startsWith("-Eoverlaps10p:promoters_TSS"))return readableNOTOverlaps("gene TSS","(10%)");else if(a.startsWith("-Eoverlaps50p:promoters_TSS"))return readableNOTOverlaps("gene TSS",
"(50%)");else if(a.startsWith("Emdd:promoters_TSS:"))return readableDistanceTo("gene TSS","downstream",2,a,2,0);else if(a.startsWith("Emud:promoters_TSS:"))return readableDistanceTo("gene TSS","upstream",2,a,2,0);else if(a.startsWith("Emmd:promoters_TSS:"))return readableDistanceTo("gene TSS","",2,a,2,0);else if(a.startsWith("Eoverlaps:bhist:"))return b=a.split(":"),readableOverlaps(b[2]+" sites in "+b[3]+" tissue","(1bp)");else if(a.startsWith("Eoverlaps10p:bhist:"))return b=a.split(":"),readableOverlaps(b[2]+
" sites in "+b[3]+" tissue","(10%)","(10%)");else if(a.startsWith("Eoverlaps50p:bhist:"))return b=a.split(":"),readableOverlaps(b[2]+" sites in "+b[3]+" tissue","(50%)");else if(a.startsWith("Eor:bhist:"))return b=a.split("--")[0].split(":"),readableOverlapRatio(b[2]+" sites in "+b[3]+" tissue",4,a);else if(a.startsWith("-Eoverlaps:bhist:"))return b=a.split(":"),readableNOTOverlaps(b[2]+" sites in "+b[3]+" tissue","(1bp)");else if(a.startsWith("-Eoverlaps10p:bhist:"))return b=a.split(":"),readableNOTOverlaps(b[2]+
" sites in "+b[3]+" tissue","(10%)");else if(a.startsWith("-Eoverlaps50p:bhist:"))return b=a.split(":"),readableNOTOverlaps(b[2]+" sites in "+b[3]+" tissue","(50%)");else if(a.startsWith("Emdd:bhist:"))return b=a.split("--")[0].split(":"),readableDistanceTo(b[2]+" sites","downstream",3,a,2,0);else if(a.startsWith("Emud:bhist:"))return b=a.split("--")[0].split(":"),readableDistanceTo(b[2]+" sites","upstream",3,a,2,0);else if(a.startsWith("Emmd:bhist:"))return b=a.split("--")[0].split(":"),readableDistanceTo(b[2]+
" sites","",3,a,2,0);else if(a.startsWith("nihrm:")){var b=a.split("--")[0].split(":"),c;if(b[3]=="oddsratio")c=5;else if(b[3]=="oddsdif")c=9;else return a;b=a.split("--");if(b.length==2)return a=b[0].split(":"),b=b[1].split(":"),"The odds ratio is between "+convertRangeToNumber(parseInt(a[4],10),3,c)+" and "+convertRangeToNumber(parseInt(b[4],10)+1,3,c)+"";else if(b.length==1)return b=b[0].split(":"),"The odds ratio is between"+convertRangeToNumber(parseInt(b[4],10),3,c)+" and "+convertRangeToNumber(parseInt(b[4],
10)+1,3,c)+" bp"}else if(a.startsWith("Eoverlaps:"))return b=a.split(":"),c=b[b.length-1],currentState.datasetInfo[c]!==void 0&&(c=currentState.datasetInfo[c].officialName),"Overlapping with "+c+" (1bp)";else if(a.startsWith("Eoverlaps10p:"))return b=a.split(":"),c=b[b.length-1],currentState.datasetInfo[c]!==void 0&&(c=currentState.datasetInfo[c].officialName),"Overlapping with "+c+" (10%)";else if(a.startsWith("Eoverlaps50p:"))return b=a.split(":"),c=b[b.length-1],currentState.datasetInfo[c]!==void 0&&
(c=currentState.datasetInfo[c].officialName),"Overlapping with "+c+" (50%)";else if(a.startsWith("-Eoverlaps:"))return b=a.split(":"),c=b[b.length-1],currentState.datasetInfo[c]!==void 0&&(c=currentState.datasetInfo[c].officialName),"Not overlapping with "+c+" (1bp)";else if(a.startsWith("-Eoverlaps10p:"))return b=a.split(":"),c=b[b.length-1],currentState.datasetInfo[c]!==void 0&&(c=currentState.datasetInfo[c].officialName),"Not overlapping with "+c+" (10%)";else if(a.startsWith("-Eoverlaps50p:"))return b=
a.split(":"),c=b[b.length-1],currentState.datasetInfo[c]!==void 0&&(c=currentState.datasetInfo[c].officialName),"Not overlapping with "+c+" (50%)";else if(a.startsWith("Emdd:"))return b=a.split(":"),c=b[1],currentState.datasetInfo[c]!==void 0&&(c=currentState.datasetInfo[c].officialName),readableDistanceTo("a "+c+" site","downstream",2,a,2,0);else if(a.startsWith("Emud:"))return b=a.split(":"),c=b[1],currentState.datasetInfo[c]!==void 0&&(c=currentState.datasetInfo[c].officialName),readableDistanceTo("a "+
c+" site","upstream",2,a,2,0);else if(a.startsWith("Emmd:"))return b=a.split(":"),c=b[1],currentState.datasetInfo[c]!==void 0&&(c=currentState.datasetInfo[c].officialName),readableDistanceTo("a "+c+" site","",2,a,2,0);else if(a.startsWith("Egn:"))return"Overlapping with gene "+a.substring(4);else if(a.slice(0,12)=="[Egn:*%23gS:")return"Overlapping with genes described by the symbol '"+a.substring(12,a.indexOf("%20"))+"'";else if(a.startsWith("gGO:"))return"Overlapping with genes annotated with "+
a.substring(4);else if(a.slice(0,14)=="[gGO:*%23gGOd:")return"Overlapping with genes annotated with GO term containing the word '"+a.substring(14,a.indexOf("%20"))+"'";else if(a.startsWith("omimID:"))return"Overlapping with genes annotated with OMIM:"+a.substring(7);else if(a.slice(0,18)=="[omimID:*%23omimD:")return"Overlapping with genes annotated with OMIM containing the word '"+a.substring(18,a.indexOf("%20"))+"'";else if(a.startsWith("EmethR:rrbs:"))return readableMethRatio("average",a.split("--")[0].split(":")[2],
3,a);else if(a.startsWith("EmethRmin:rrbs:"))return readableMethRatio("minimum",a.split("--")[0].split(":")[2],3,a);else if(a.startsWith("EmethRmax:rrbs:"))return readableMethRatio("maximum",a.split("--")[0].split(":")[2],3,a);else if(a.startsWith("EmethRstd:rrbs:"))return readableMethRatio("standard deviation of",a.split("--")[0].split(":")[2],3,a);else if(a.startsWith("Ersc:"))if(b=a.split("--"),b.length==2)return"The region score is between "+parseInt(b[0].substr(5),10)+" and "+parseInt(b[1].substr(5),
10);else{if(b.length==1)return"The region score is "+parseInt(b[0].substr(5),10)}else if(a.startsWith("Erst:"))return"Strand "+a.substr(5);else if(a.startsWith("EmethCpG:rrbs:"))if(b=a.split("--"),c=b[0].split(":"),b.length==2)return a=b[1].split(":"),"The number of measured CpGs in "+c[2]+" is between "+convertRatioToNumber(parseInt(c[3],10),0)+" and "+convertRatioToNumber(1+parseInt(a[3],10),0);else{if(b.length==1)return"The number of measured CpGs in "+c[2]+" is between "+convertRatioToNumber(parseInt(c[3],
10),0)+" and "+convertRatioToNumber(1+parseInt(c[3],10),0)}else if(a.startsWith("gGONG:"))if(b=a.split("--"),c=b[0].split(":"),b.length==2)return a=b[1].split(":"),"GO terms associated with between "+convertRangeToNumber(parseInt(c[1],10),3,0)+" and "+convertRangeToNumber(parseInt(a[1],10)+1,3,0)+" genes";else{if(b.length==1)return"GO terms associated with between "+convertRangeToNumber(parseInt(c[1],10),3,0)+" and "+convertRangeToNumber(parseInt(c[1],10)+1,3,0)+" genes"}else return a}
function getGroupOrderElem(a){var b={hg18summary:10,featureBox:15,hg18_dna_sequence:30,location:30,histones:40,H3K4me1:111,H3K4me2:112,H3K4me3:113,H3K9ac:120,H3K9me1:121,H3K27ac:130,H3K27me3:133,H3K36me3:143,H4K20me1:160,CTCF:180,Pol2b:190,DNaseI:45,hg18_uw_DNaseI:45,methylation:50,chmm:58,chmm01aprom:101,chmm02wprom:102,chmm03pprom:103,chmm04strenh:104,chmm05strenh:105,chmm06wenh:106,chmm07wenh:107,chmm08ins:108,chmm09trtr:109,chmm10trel:110,chmm11wtrx:111,chmm12prepr:112,chmm13hetr:113,chmm14rcnv:114,
chmm15rcnv:115,hg18_ucsc_cpg_islands:60,hg18_cgihunter_CpG_Islands:65,hg18_conservation:68,hg18_repeat_masker:70,generelated:80,hg18_ensembl_gene_genes:45,promoters:50,hg18_ensembl_gene_promoters:10,hg18_ensembl_gene_promoters_centered:20,hg18_ensembl_gene_promoters_region:30,hg18_ensembl_gene_TSS:60,hg18_ensembl_gene_exons:70,hg18_ensembl_gene_introns:98,"OMIM:TERMS:":"090",User:99,distanceTo:98};return b[a]!==void 0?b[a]:a.startsWith("Emmd:")?"088":"0"+a.length}
function getOverlapSummaryForGroup(a){var b={hg18summary:"OVERLAP:bhist:H3K4me1:TISSUE,OVERLAP:bhist:H3K4me3:TISSUE,OVERLAP:bhist:H3K27me3:TISSUE,OVERLAP:bhist:H3K36me3:TISSUE,OVERLAP:DNaseI:TISSUE,OVERLAP:chmm04strenh:TISSUE,OVERLAP:chmm08ins:TISSUE,OVERLAP:ucscCGI,OVERLAP:cons,OVERLAP:repeats:any,OVERLAP:promoters_def,OVERLAP:genes",repeats:"OVERLAP:repeats:any,OVERLAP:repeats:DNA,OVERLAP:repeats:snRNA,OVERLAP:repeats:Low_complexity,OVERLAP:repeats:LINE,OVERLAP:repeats:SINE,OVERLAP:repeats:Simple_repeat,OVERLAP:repeats:srpRNA,OVERLAP:repeats:scRNA,OVERLAP:repeats:LTR,OVERLAP:repeats:RC,OVERLAP:repeats:rRNA,OVERLAP:repeats:RNA,OVERLAP:repeats:tRNA,OVERLAP:repeats:Satellite,OVERLAP:repeats:Other,OVERLAP:repeats:Unknown",
hg18_uw_DNaseI:"OVERLAP:DNaseI:any,OVERLAP:DNaseI:GM12878,OVERLAP:DNaseI:H1hESC,OVERLAP:DNaseI:HepG2,OVERLAP:DNaseI:NHLF,OVERLAP:DNaseI:HUVEC,OVERLAP:DNaseI:NHEK,OVERLAP:DNaseI:K562,OVERLAP:DNaseI:HeLaS3,OVERLAP:DNaseI:HMEC",generelated:"OVERLAP:genes,OVERLAP:promoters_def,OVERLAP:promoters_cen,OVERLAP:promoters_reg,OVERLAP:exons,OVERLAP:promoters_TSS",histones:"OVERLAP:bhist:CTCF:TISSUE,OVERLAP:bhist:H3K4me1:TISSUE,OVERLAP:bhist:H3K4me2:TISSUE,OVERLAP:bhist:H3K4me3:TISSUE,OVERLAP:bhist:H3K9ac:TISSUE,OVERLAP:bhist:H3K9me1:TISSUE,OVERLAP:bhist:H3K27ac:TISSUE,OVERLAP:bhist:H3K27me3:TISSUE,OVERLAP:bhist:H4K20me1:TISSUE,OVERLAP:bhist:H3K36me3:TISSUE,OVERLAP:bhist:Pol2b:TISSUE",
Pol2b:"OVERLAP:bhist:Pol2b:any,OVERLAP:bhist:Pol2b:HUVEC,OVERLAP:bhist:Pol2b:K562,OVERLAP:bhist:Pol2b:NHEK",H4K20me1:"OVERLAP:bhist:H4K20me1:any,OVERLAP:bhist:H4K20me1:GM12878,OVERLAP:bhist:H4K20me1:H1hESC,OVERLAP:bhist:H4K20me1:HepG2,OVERLAP:bhist:H4K20me1:HMEC,OVERLAP:bhist:H4K20me1:HSMM,OVERLAP:bhist:H4K20me1:HUVEC,OVERLAP:bhist:H4K20me1:K562,OVERLAP:bhist:H4K20me1:NHEK,OVERLAP:bhist:H4K20me1:NHLF",H3K36me3:"OVERLAP:bhist:H3K36me3:any,OVERLAP:bhist:H3K36me3:GM12878,OVERLAP:bhist:H3K36me3:H1hESC,OVERLAP:bhist:H3K36me3:HepG2,OVERLAP:bhist:H3K36me3:HMEC,OVERLAP:bhist:H3K36me3:HSMM,OVERLAP:bhist:H3K36me3:HUVEC,OVERLAP:bhist:H3K36me3:K562,OVERLAP:bhist:H3K36me3:NHEK,OVERLAP:bhist:H3K36me3:NHLF",
H3K27me3:"OVERLAP:bhist:H3K27me3:any,OVERLAP:bhist:H3K27me3:GM12878,OVERLAP:bhist:H3K27me3:H1hESC,OVERLAP:bhist:H3K27me3:HMEC,OVERLAP:bhist:H3K27me3:HSMM,OVERLAP:bhist:H3K27me3:HUVEC,OVERLAP:bhist:H3K27me3:K562,OVERLAP:bhist:H3K27me3:NHEK,OVERLAP:bhist:H3K27me3:NHLF",H3K27ac:"OVERLAP:bhist:H3K27ac:any,OVERLAP:bhist:H3K27ac:GM12878,OVERLAP:bhist:H3K27ac:HepG2,OVERLAP:bhist:H3K27ac:HMEC,OVERLAP:bhist:H3K27ac:HSMM,OVERLAP:bhist:H3K27ac:HUVEC,OVERLAP:bhist:H3K27ac:K562,OVERLAP:bhist:H3K27ac:NHEK,OVERLAP:bhist:H3K27ac:NHLF",
H3K9me1:"OVERLAP:bhist:H3K9me1:any,OVERLAP:bhist:H3K9me1:HUVEC,OVERLAP:bhist:H3K9me1:K562,OVERLAP:bhist:H3K9me1:NHEK",H3K9ac:"OVERLAP:bhist:H3K9ac:any,OVERLAP:bhist:H3K9ac:GM12878,OVERLAP:bhist:H3K9ac:H1hESC,OVERLAP:bhist:H3K9ac:HepG2,OVERLAP:bhist:H3K9ac:HMEC,OVERLAP:bhist:H3K9ac:HSMM,OVERLAP:bhist:H3K9ac:HUVEC,OVERLAP:bhist:H3K9ac:K562,OVERLAP:bhist:H3K9ac:NHEK,OVERLAP:bhist:H3K9ac:NHLF",H3K4me3:"OVERLAP:bhist:H3K4me3:any,OVERLAP:bhist:H3K4me3:GM12878,OVERLAP:bhist:H3K4me3:H1hESC,OVERLAP:bhist:H3K4me3:HepG2,OVERLAP:bhist:H3K4me3:HMEC,OVERLAP:bhist:H3K4me3:HSMM,OVERLAP:bhist:H3K4me3:HUVEC,OVERLAP:bhist:H3K4me3:K562,OVERLAP:bhist:H3K4me3:NHEK,OVERLAP:bhist:H3K4me3:NHLF",
H3K4me2:"OVERLAP:bhist:H3K4me2:any,OVERLAP:bhist:H3K4me2:GM12878,OVERLAP:bhist:H3K4me2:H1hESC,OVERLAP:bhist:H3K4me2:HepG2,OVERLAP:bhist:H3K4me2:HMEC,OVERLAP:bhist:H3K4me2:HSMM,OVERLAP:bhist:H3K4me2:HUVEC,OVERLAP:bhist:H3K4me2:K562,OVERLAP:bhist:H3K4me2:NHEK,OVERLAP:bhist:H3K4me2:NHLF",H3K4me1:"OVERLAP:bhist:H3K4me1:any,OVERLAP:bhist:H3K4me1:GM12878,OVERLAP:bhist:H3K4me1:H1hESC,OVERLAP:bhist:H3K4me1:HMEC,OVERLAP:bhist:H3K4me1:HSMM,OVERLAP:bhist:H3K4me1:HUVEC,OVERLAP:bhist:H3K4me1:K562,OVERLAP:bhist:H3K4me1:NHEK,OVERLAP:bhist:H3K4me1:NHLF",
CTCF:"OVERLAP:bhist:CTCF:any,OVERLAP:bhist:CTCF:GM12878,OVERLAP:bhist:CTCF:H1hESC,OVERLAP:bhist:CTCF:HepG2,OVERLAP:bhist:CTCF:HMEC,OVERLAP:bhist:CTCF:HSMM,OVERLAP:bhist:CTCF:HUVEC,OVERLAP:bhist:CTCF:K562,OVERLAP:bhist:CTCF:NHEK,OVERLAP:bhist:CTCF:NHLF",chmm:"OVERLAP:chmm01aprom:TISSUE,OVERLAP:chmm02wprom:TISSUE,OVERLAP:chmm03pprom:TISSUE,OVERLAP:chmm04strenh:TISSUE,OVERLAP:chmm05strenh:TISSUE,OVERLAP:chmm06wenh:TISSUE,OVERLAP:chmm07wenh:TISSUE,OVERLAP:chmm08ins:TISSUE,OVERLAP:chmm09trtr:TISSUE,OVERLAP:chmm10trel:TISSUE,OVERLAP:chmm11wtrx:TISSUE,OVERLAP:chmm12prepr:TISSUE,OVERLAP:chmm13hetr:TISSUE,OVERLAP:chmm14rcnv:TISSUE,OVERLAP:chmm15rcnv:TISSUE",
chmm01aprom:"OVERLAP:chmm01aprom:GM12878,OVERLAP:chmm01aprom:H1hESC,OVERLAP:chmm01aprom:HepG2,OVERLAP:chmm01aprom:HMEC,OVERLAP:chmm01aprom:HSMM,OVERLAP:chmm01aprom:HUVEC,OVERLAP:chmm01aprom:K562,OVERLAP:chmm01aprom:NHEK,OVERLAP:chmm01aprom:NHLF,OVERLAP:chmm01aprom:any",chmm02wprom:"OVERLAP:chmm02wprom:GM12878,OVERLAP:chmm02wprom:H1hESC,OVERLAP:chmm02wprom:HepG2,OVERLAP:chmm02wprom:HMEC,OVERLAP:chmm02wprom:HSMM,OVERLAP:chmm02wprom:HUVEC,OVERLAP:chmm02wprom:K562,OVERLAP:chmm02wprom:NHEK,OVERLAP:chmm02wprom:NHLF,OVERLAP:chmm02wprom:any",
chmm03pprom:"OVERLAP:chmm03pprom:GM12878,OVERLAP:chmm03pprom:H1hESC,OVERLAP:chmm03pprom:HepG2,OVERLAP:chmm03pprom:HMEC,OVERLAP:chmm03pprom:HSMM,OVERLAP:chmm03pprom:HUVEC,OVERLAP:chmm03pprom:K562,OVERLAP:chmm03pprom:NHEK,OVERLAP:chmm03pprom:NHLF,OVERLAP:chmm03pprom:any",chmm04strenh:"OVERLAP:chmm04strenh:GM12878,OVERLAP:chmm04strenh:H1hESC,OVERLAP:chmm04strenh:HepG2,OVERLAP:chmm04strenh:HMEC,OVERLAP:chmm04strenh:HSMM,OVERLAP:chmm04strenh:HUVEC,OVERLAP:chmm04strenh:K562,OVERLAP:chmm04strenh:NHEK,OVERLAP:chmm04strenh:NHLF,OVERLAP:chmm04strenh:any",
chmm05strenh:"OVERLAP:chmm05strenh:GM12878,OVERLAP:chmm05strenh:H1hESC,OVERLAP:chmm05strenh:HepG2,OVERLAP:chmm05strenh:HMEC,OVERLAP:chmm05strenh:HSMM,OVERLAP:chmm05strenh:HUVEC,OVERLAP:chmm05strenh:K562,OVERLAP:chmm05strenh:NHEK,OVERLAP:chmm05strenh:NHLF,OVERLAP:chmm05strenh:any",chmm06wenh:"OVERLAP:chmm06wenh:GM12878,OVERLAP:chmm06wenh:H1hESC,OVERLAP:chmm06wenh:HepG2,OVERLAP:chmm06wenh:HMEC,OVERLAP:chmm06wenh:HSMM,OVERLAP:chmm06wenh:HUVEC,OVERLAP:chmm06wenh:K562,OVERLAP:chmm06wenh:NHEK,OVERLAP:chmm06wenh:NHLF,OVERLAP:chmm06wenh:any",
chmm07wenh:"OVERLAP:chmm07wenh:GM12878,OVERLAP:chmm07wenh:H1hESC,OVERLAP:chmm07wenh:HepG2,OVERLAP:chmm07wenh:HMEC,OVERLAP:chmm07wenh:HSMM,OVERLAP:chmm07wenh:HUVEC,OVERLAP:chmm07wenh:K562,OVERLAP:chmm07wenh:NHEK,OVERLAP:chmm07wenh:NHLF,OVERLAP:chmm07wenh:any",chmm08ins:"OVERLAP:chmm08ins:GM12878,OVERLAP:chmm08ins:H1hESC,OVERLAP:chmm08ins:HepG2,OVERLAP:chmm08ins:HMEC,OVERLAP:chmm08ins:HSMM,OVERLAP:chmm08ins:HUVEC,OVERLAP:chmm08ins:K562,OVERLAP:chmm08ins:NHEK,OVERLAP:chmm08ins:NHLF,OVERLAP:chmm08ins:any",
chmm09trtr:"OVERLAP:chmm09trtr:GM12878,OVERLAP:chmm09trtr:H1hESC,OVERLAP:chmm09trtr:HepG2,OVERLAP:chmm09trtr:HMEC,OVERLAP:chmm09trtr:HSMM,OVERLAP:chmm09trtr:HUVEC,OVERLAP:chmm09trtr:K562,OVERLAP:chmm09trtr:NHEK,OVERLAP:chmm09trtr:NHLF,OVERLAP:chmm09trtr:any",chmm10trel:"OVERLAP:chmm10trel:GM12878,OVERLAP:chmm10trel:H1hESC,OVERLAP:chmm10trel:HepG2,OVERLAP:chmm10trel:HMEC,OVERLAP:chmm10trel:HSMM,OVERLAP:chmm10trel:HUVEC,OVERLAP:chmm10trel:K562,OVERLAP:chmm10trel:NHEK,OVERLAP:chmm10trel:NHLF,OVERLAP:chmm10trel:any",
chmm11wtrx:"OVERLAP:chmm11wtrx:GM12878,OVERLAP:chmm11wtrx:H1hESC,OVERLAP:chmm11wtrx:HepG2,OVERLAP:chmm11wtrx:HMEC,OVERLAP:chmm11wtrx:HSMM,OVERLAP:chmm11wtrx:HUVEC,OVERLAP:chmm11wtrx:K562,OVERLAP:chmm11wtrx:NHEK,OVERLAP:chmm11wtrx:NHLF,OVERLAP:chmm11wtrx:any",chmm12prepr:"OVERLAP:chmm12prepr:GM12878,OVERLAP:chmm12prepr:H1hESC,OVERLAP:chmm12prepr:HepG2,OVERLAP:chmm12prepr:HMEC,OVERLAP:chmm12prepr:HSMM,OVERLAP:chmm12prepr:HUVEC,OVERLAP:chmm12prepr:K562,OVERLAP:chmm12prepr:NHEK,OVERLAP:chmm12prepr:NHLF,OVERLAP:chmm12prepr:any",
chmm13hetr:"OVERLAP:chmm13hetr:GM12878,OVERLAP:chmm13hetr:H1hESC,OVERLAP:chmm13hetr:HepG2,OVERLAP:chmm13hetr:HMEC,OVERLAP:chmm13hetr:HSMM,OVERLAP:chmm13hetr:HUVEC,OVERLAP:chmm13hetr:K562,OVERLAP:chmm13hetr:NHEK,OVERLAP:chmm13hetr:NHLF,OVERLAP:chmm13hetr:any",chmm14rcnv:"OVERLAP:chmm14rcnv:GM12878,OVERLAP:chmm14rcnv:H1hESC,OVERLAP:chmm14rcnv:HepG2,OVERLAP:chmm14rcnv:HMEC,OVERLAP:chmm14rcnv:HSMM,OVERLAP:chmm14rcnv:HUVEC,OVERLAP:chmm14rcnv:K562,OVERLAP:chmm14rcnv:NHEK,OVERLAP:chmm14rcnv:NHLF,OVERLAP:chmm14rcnv:any",
chmm15rcnv:"OVERLAP:chmm15rcnv:GM12878,OVERLAP:chmm15rcnv:H1hESC,OVERLAP:chmm15rcnv:HepG2,OVERLAP:chmm15rcnv:HMEC,OVERLAP:chmm15rcnv:HSMM,OVERLAP:chmm15rcnv:HUVEC,OVERLAP:chmm15rcnv:K562,OVERLAP:chmm15rcnv:NHEK,OVERLAP:chmm15rcnv:NHLF,OVERLAP:chmm15rcnv:any",methylation:"OVERLAP:rrbs:hES_H1_p38:unmeth,OVERLAP:rrbs:hES_H9_p58:unmeth,OVERLAP:rrbs:hFib_11_p8:unmeth,OVERLAP:rrbs:Fetal_kidney:unmeth,OVERLAP:rrbs:Fetal_lung:unmeth,OVERLAP:rrbs:Fetal_brain:unmeth,OVERLAP:rrbs:Smooth_muscle:unmeth,OVERLAP:rrbs:Stomach_mucosa:unmeth,OVERLAP:rrbs:Neuron_H9_derived:unmeth,OVERLAP:rrbs:NPC_H9_derived:unmeth",
hES_H1_p38:"OVERLAP:rrbs:hES_H1_p38:unmeth,OVERLAP:rrbs:hES_H1_p38:meth",hES_H9_p58:"OVERLAP:rrbs:hES_H9_p58:unmeth,OVERLAP:rrbs:hES_H9_p58:meth",hFib_11_p8:"OVERLAP:rrbs:hFib_11_p8:unmeth,OVERLAP:rrbs:hFib_11_p8:meth",hEB16d_H1_p38:"OVERLAP:rrbs:hEB16d_H1_p38:unmeth,OVERLAP:rrbs:hEB16d_H1_p38:meth",fetal_heart:"OVERLAP:rrbs:fetal_heart:unmeth,OVERLAP:rrbs:fetal_heart:meth",Fetal_kidney:"OVERLAP:rrbs:Fetal_kidney:unmeth,OVERLAP:rrbs:Fetal_kidney:meth",Fetal_lung:"OVERLAP:rrbs:Fetal_lung:unmeth,OVERLAP:rrbs:Fetal_lung:meth",
Fetal_brain:"OVERLAP:rrbs:Fetal_brain:unmeth,OVERLAP:rrbs:Fetal_brain:meth",Smooth_muscle:"OVERLAP:rrbs:Smooth_muscle:unmeth,OVERLAP:rrbs:Smooth_muscle:meth",Skeletal_muscle:"OVERLAP:rrbs:Skeletal_muscle:unmeth,OVERLAP:rrbs:Skeletal_muscle:meth",Stomach_mucosa:"OVERLAP:rrbs:Stomach_mucosa:unmeth,OVERLAP:rrbs:Stomach_mucosa:meth",Neuron_H9_derived:"OVERLAP:rrbs:Neuron_H9_derived:unmeth,OVERLAP:rrbs:Neuron_H9_derived:meth",NPC_H9_derived:"OVERLAP:rrbs:NPC_H9_derived:unmeth,OVERLAP:rrbs:NPC_H9_derived:meth",
Human_blood_CD34_mobilized_REMC:"OVERLAP:rrbs:Human_blood_CD34_mobilized_REMC:unmeth,OVERLAP:rrbs:Human_blood_CD34_mobilized_REMC:meth"};return b[a]!==void 0?b[a]:""}
function getTextForPlotDescription(a){var b={genes:"The table shows information for Ensembl genes that are within 5kb from some of the regions from the current selection. You may search for a specific gene by Ensembl identifier or gene symbo using the search box on top. You can refine the current selection of regions to only those nearby a specific gene using the ion in the rightmost column of the table.",goterms:"The table shows the most common Gene Ontology terms associated with a gene that is within 5kb from some of the region from the current selection. An enrichment ratio is computed for every GO term as the number of regions nearby genes associated with the GO term is divided by the total number of genes associated with the GO term. These ratios are then used in the visualization on the right, as the font size of each GO term is proportional to its ratio. The actual GOs that are visualized may be refined via the search box and the slider on top. The search box allows you to easily find a particular GO term or GO terms described by one or several words. The slider is used to restrict to GOs with a specific number of genes. Finally, you can refine the current selection of regions to only those associated with a specific GO using the icon in the rightmost column of the table.",
gowords:"The table shows the most common words describing Gene Ontology terms associated with genes within 5kb from some of the regions from the current selection. The size of the words in the cloud is proportional to the frequency of the words. You can search for a particular word using the search box on top. You can refine the current selection of regions to only those associated with a GO term described by a specific word using the icon in the rightmost column of the table.",omimterms:"The table shows the most common OMIM categories that are associated with a gene that is within 5kb from some of the region from the current selection. An enrichment ratio is computed for every OMIM as the number of regions nearby genes associated with the OMIM is divided by the total number of genes associated with the OMIM. These ratios are then used in the visualization on the right, as the font size of each OMIM is proportional to its ratio. You can search for particular OMIMs or OMIMs described by a one or several words using the search box on top. Finally, you can refine the current selection of regions to only those associated with a specific OMIM using the icon in the rightmost column of the table.",
omimwords:"The table shows the most common words describing OMIM categories associated with genes within 5kb from some of the regions from the current selection. The size of the words in the cloud is proportional to the frequency of the words.You can search for a particular word using the search box on top. You can refine the current selection of regions to only those associated with an OMIM described by a specific word using the icon in the rightmost column of the table.",rangepie:"The pie chart on the left shows the overall distribution of the score and the area chart on the right offers a more detailed view on a specific part of it. You may update this view by clicking on a different area of the pie or on the legend. In most cases, you may refine the current selection of regions to only those with a particular value of the score using the slider on the left to select a range and pressing the 'Filter to this selection' button.",
rangecolumn:"The stacked column chart on the left shows the overall distribution of the score and the area chart on the right offers a more detailed view on one specific part of it. You may update this view by clicking on a different area of the columns or on the legend. In most cases, you may refine the current selection of regions to only those with a particular value of the score using the slider on the left to select a range and pressing the 'Filter to this selection' button.",ratio:"The area chart displays the distribution of a particular score. The y-axis of every point indicates the percent of all regions(the number of regions is also shown in the tool-tip) that have between the value displayed on the x-axis and the next. Note that the sum of all should not necessary be 100% as some scores are only present if a region has a particular property. For example, if the diagram is showing overlap ratio of the current selection of regions with CpG islands, it will only show the distribution of the regions that overlap with CpG islands and since these are often less than 100% the sum of all percentages will also be. In most cases, you may refine the current selection of regions to only those with a particular value of the score using the slider on the left to select a range and pressing the 'Filter to this selection' button.",
neighborhoodref:"The neighborhood chart is used to give intuition about the relative distribution of histone marks nearby the current selection of regions. The x-axis shows an ordered list of predefined positions relative to the start and the end of the regions and the y-axis specifies in what percent of the regions a particular histone modification is observed in particular tissue at the relative position.Please note that, data is measured only for the points listed on the x-axis and the individual points are connected by a line to be easier to grasp visually. However, the line does not necessary reflect the exact behavior of all points between the specified relative positions. You may can change the focus tissue by selecting another from the table with tissues.",
neighborhoodsingle:"The neighborhood chart is used to give intuition about the relative distribution of histone marks nearby the current selection of regions. The x-axis shows an ordered list of predefined positions relative to the start and the end of the regions and the y-axis specifies in what percent of the regions a particular histone modification is observed in particular tissue at the relative position.Please note that, data is measured only for the points listed on the x-axis and the individual points are connected by a line to be easier to grasp visually. However, the line does not necessary reflect the exact behavior of all points between the specified relative positions. You can exclude tissues from the visualization by clickin on them in the diagram or in the legend.",
overlaptable:"The bar chart has listed features on the x-axis. For each of this features the height of the corresponding column (or the value on the y-axis) indicates the percentage of regions from the current selection of regions that have the particular property. You can select any of those properties as a refinement of your current selection of regions by clicking on it in the listing on the left. In some cases, a more detailed view is available for the particular properties. <div class='ui-icon ui-icon-zoomin' style='display:inline-block;'/> icon can then be found next to the each listed property on the left. In that case, you may visualize the more detailed view by clicking on the icon or clicking on the column in the bar chart.",
nodescription:""};return b[a]!==void 0?b[a]:"'"+a+"' plot description (TODO insert description for this figure type)"}
function getTextForFeatureDescription(a){var b={hg18_dna_sequence:"visualizes the distribution of the frequencies of sequence patterns, such as CpG and CpA for the current selection of dataset regions",hg18summary:"shows general information for the dataset","regionList:":"shows several regions from the current refinement","Elength_magnitude:":"shows the distributions of the lengths of the regions",hg18_repeat_masker:"shows overlap information for different types of repeat elements obtained with the repeat masker program <a href='http://genome.ucsc.edu/cgi-bin/hgTrackUi?hgsid=165805886&c=chr12&g=rmskRM327' target='_blank'>Source</a>",
location:"shows the distribution of the regions across the different chromosomes",generelated:"shows information for colocalization of the current set of regions with various gene structural elements (promoters, TSS and exons) or annotations such as GO and OMIM terms and categories <a href='http://www.ensembl.org/Homo_sapiens/Info/Index' target='_blank'>Source</a>",hg18_ensembl_gene_genes:"explores the overlap, overlap ratio or proximity to gene elements <a href='http://www.ensembl.org/Homo_sapiens/Info/Index' target='_blank'>Source</a>",
promoters:"show different promoter annotations",hg18_ensembl_gene_promoters:"visualize properties for gene promoters defined as 5kb upstream to 1kb downstream of gene TSS",hg18_ensembl_gene_promoters_centered:"visualize properties for gene promoters defined as 1kb upstream to 1kb downstream of gene TSS",hg18_ensembl_gene_promoters_region:"visualize properties for gene promoters defined as 10kb upstream to 2kb downstream of gene TSS",hg18_ensembl_gene_TSS:" transcription start sites of Ensembl genes ",
hg18_ensembl_gene_exons:"all exons of Ensembl genes",hg18_conservation:"conserved elements from the UCSC Genome Browser <a href='http://genome.ucsc.edu/cgi-bin/hgTrackUi?hgsid=171724329&c=chr17&g=mostConserved28way' target='_blank'>Source</a>",hg18_ucsc_cpg_islands:"CpG islands annotation from the UCSC Genome Browser <a href='http://genome.ucsc.edu/cgi-bin/hgTables?db=hg18&hgta_group=regulation&hgta_track=cpgIslandExt&hgta_table=cpgIslandExt&hgta_doSchema=describe+table+schema' target='_blank'>Source</a>",
hg18_cgihunter_CpG_Islands:"CpG island annotation using the CGIHunter software <a href='http://cgihunter.bioinf.mpi-inf.mpg.de/index.php' target='_blank'>Source</a>",hg18_uw_DNaseI:"shows DNaseI sensitivity measured genome-wide in different cell lines using the Digital DNaseI methodology <a href='http://genome.ucsc.edu/cgi-bin/hgTables?db=hg18&hgta_group=regulation&hgta_track=wgEncodeUwDnaseSeq&hgta_table=wgEncodeUwDnaseSeqPeaksRep2Gm12865&hgta_doSchema=describe+table+schema' target='_blank'>Source</a>",
histones:"maps of chromatin state generated by the Broad/MGH ENCODE group using ChIP-seq <a href='http://genome.ucsc.edu/cgi-bin/hgTrackUi?hgsid=165805886&c=chr12&g=wgEncodeBroadChipSeq' target='_blank'>Source</a>",CTCF:"CTCF zinc finger transcription factor. A sequence specific DNA binding protein that functions as an insulator, blocking enhancer activity. It has also been suggested to block the spreading of chromatin structure in certain instances.<a href='http://genome.ucsc.edu/cgi-bin/hgEncodeVocab?ra=encode%2Fcv.ra&target=%22CTCF%22' target='_blank'>Source</a>",
Pol2b:"RNA polymerase II. Is responsible for RNA transcription. It is generally enriched at 5' gene ends, probably due to higher rate of occupancy associated with transition from initiation to elongation.<a href='http://genome.ucsc.edu/cgi-bin/hgEncodeVocab?ra=encode%2Fcv.ra&target=%22Pol2%28b%29%22' target='_blank'>Source</a>",H3K9ac:"\tHistone H3 (acetyl K9). As with H3K27ac, associated with transcriptional initiation and open chromatin structure. <a href='http://genome.ucsc.edu/cgi-bin/hgEncodeVocab?ra=encode%2Fcv.ra&target=%22H3K9ac%22' target='_blank'>Source</a>",
H3K27ac:"Histone H3 (acetyl K27). As with H3K9ac, associated with transcriptional initiation and open chromatin structure. It remains unknown whether acetylation has can have different consequences depending on the specific lysine residue targeted. In general, though, there appears to be high redundancy. Histone acetylation is notable for susceptibility to small molecules and drugs that target histone deacetylases.<a href='http://genome.ucsc.edu/cgi-bin/hgEncodeVocab?ra=encode%2Fcv.ra&target=%22H3K27ac%22' target='_blank'>Source</a>",
H3K4me1:"\tHistone H3 (mono methyl K4). Is associated with enhancers, and downstream of transcription starts.<a href='http://genome.ucsc.edu/cgi-bin/hgEncodeVocab?ra=encode%2Fcv.ra&target=%22H3K4me1%22' target='_blank'>Source</a>",H3K4me2:"Histone H3 (di methyl K4). Marks promoters and enhancers. Most CpG islands are marked by H3K4me2 in primary cells. May be associated also with poised promoters.<a href='http://genome.ucsc.edu/cgi-bin/hgEncodeVocab?ra=encode%2Fcv.ra&target=%22H3K4me2%22' target='_blank'>Source</a>",
H3K4me3:"\tHistone H3 (tri methyl K4). Marks promoters that are active or poised to be activated.<a href='http://genome.ucsc.edu/cgi-bin/hgEncodeVocab?ra=encode%2Fcv.ra&target=%22H3K4me3%22' target='_blank'>Source</a>",H3K9me1:"Histone H3 (mono-methyl K9). Is associated with active and accessible regions. NOTE CONTRAST to H3K9me3 which is associated with repressive heterochromatic state.<a href='http://genome.ucsc.edu/cgi-bin/hgEncodeVocab?ra=encode%2Fcv.ra&target=%22H3K9me1%22' target='_blank'>Source</a>",
H3K27me3:"Histone H3 (tri-methyl K27). Marks promoters that are silenced by Polycomb proteins in a given lineage; large domains are found at inactive developmental loci.<a href='http://genome.ucsc.edu/cgi-bin/hgEncodeVocab?ra=encode%2Fcv.ra&target=%22H3K27me3%22' target='_blank'>Source</a>",H3K36me3:"Histone H3 (tri-methyl K36). Marks regions of RNAPII elongation, including coding and non-coding transcripts. <a href='http://genome.ucsc.edu/cgi-bin/hgEncodeVocab?ra=encode%2Fcv.ra&target=%22H3K36me3%22' target='_blank'>Source</a>",
H4K20me1:"Histone H4 (mono-methyl K20). Is associated with active and accessible regions. In mammals, PR-Set7 specifically catalyzes H4K20 monomethylation. NOTE CONTRAST to H3K20me3 which is associated with heterochromatin and DNA repair.<a href='http://genome.ucsc.edu/cgi-bin/hgEncodeVocab?ra=encode%2Fcv.ra&target=%22H4K20me1%22' target='_blank'>Source</a>",distanceTo:"",methylation:"DNA methylation was obtained using the reduced representation bisulphite sequencing method (see Meissner and Mikkelsen et al. Nature 2008)",
User:"overlaps and distance to user-defined genome annotations"};return b[a]!==void 0?b[a]:"'"+a+"' description (TODO insert description for this feature)"}
function getTextForFeatureGroup(a){var b={hg18_dna_sequence:"DNA sequence",hg18_repeat_masker:"Repeat elements",hg18_ucsc_cpg_islands:"CpG islands (specific)",DNaseI:"DNaseI hypersensitive sites (ENCODE)",hg18_uw_DNaseI:"DNaseI hypersensitive sites (ENCODE)",hg18_ensembl_gene_exons:"Gene exons",hg18_ensembl_gene_genes:"Genes",hg18_ensembl_gene_introns:"Gene introns",hg18_conservation:"Conservation",hg18_cgihunter_CpG_Islands:"CpG islands (sensitive)",hg18_ensembl_gene_promoters_centered:"Gene promoters (-1kb to 1kb)",
hg18_ensembl_gene_promoters_region:" Gene promoters (-10kb to 2kb)",hg18_ensembl_gene_promoters:" Gene promoters (-5kb to 1kb)",hg18_ensembl_gene_TSS:" Gene transcription start sites",location:"Region location",hg18summary:"Summary",generelated:"Genes and annotations",promoters:"Gene promoters",histones:"Histone modifications (ENCODE)",distanceTo:"Distance to nearest",methylation:"DNA methylation (ROADMAP)",chmm:"Chromatin state segmentation",chmm01aprom:"Active promoters (1)",chmm02wprom:"Weak promoters (2)",
chmm03pprom:"Poised promoters (3)",chmm04strenh:"Strong enhancers (4)",chmm05strenh:"Strong enhancers (5)",chmm06wenh:"Weak enhancers (6)",chmm07wenh:"Weak enhancers (7)",chmm08ins:"Insulators (8)",chmm09trtr:"Transcriptional transition (9)",chmm10trel:"Transcriptional elongation (10)",chmm11wtrx:"Weak transcribed (11)",chmm12prepr:"Polycomb repressed (12)",chmm13hetr:"Heterochromatin (low signal) (13)",chmm14rcnv:"Repetitive/CNV (14)",chmm15rcnv:"Repetitive/CNV (15)",User:"User annotations"};return b[a]!==
void 0?b[a]:a}
function getTextForFeaturePrefix(a){return a=="Elength_magnitude:"?"Region lengths":a=="Echr:"?"by chromosome":a.startsWith("Emud:")?"upstream":a.startsWith("Emdd:")?"downstream":a.startsWith("Emmd:chmm")?a.split(":")[2]:a.startsWith("Emmd:DNaseI:")?a.split(":")[2]:a.startsWith("Emmd:")?"Distance to nearest":a.startsWith("-OVERLAP")?"Not overlapping":a.startsWith("OVERLAP")?"Overlapping":a.startsWith("Eor:")?"Overlap ratio":a.startsWith("Ednaseq:")?"Frequency of "+a.split(":")[1]:a.startsWith("Enbh:")?"Neighborhood":
a.startsWith("regionList:")?"List the regions":a.startsWith("GENENAME:ENSEMBL")?"Gene names (Ensembl)":a.startsWith("GO:TERMS")?"Gene ontology (words)":a.startsWith("GO:ALL")?"Gene ontology (terms)":a.startsWith("OMIM:TERMS")?"OMIM (words)":a.startsWith("OMIM:ALL")?"OMIM (terms)":a.startsWith("EmethCpG:")?"Number of observed CpGs":a.startsWith("EmethR:")?"Average CpG methylation ratio":a.startsWith("EmethRmin:")?"Min methylation ratio of a CpG":a.startsWith("EmethRmax:")?"Max methylation ratio of a CpG":
a.startsWith("EmethRstd:")?"Deviation of the methylation ratios of CpGs":a=="Ersc:"?"Region score":a=="Erst:"?"Region strand":a}
function getTypeForFeaturePrefix(a){var b;a.startsWith("Elength_magnitude")?b="featureRange":a.startsWith("Emmd:")?b="featureRange":a.startsWith("Emud:")?b="featureRange":a.startsWith("Emdd:")?b="featureRange":a.startsWith("Echr:")?b="featureText":a.startsWith("Erst:")?b="featureText":a.startsWith("-OVERLAP:")?b="featureText":a.startsWith("OVERLAP:")?b="featureText":a.startsWith("Eor:")?b="featureRatio":a.startsWith("Ersc:")?b="featureRatio":a.startsWith("Ednaseq:")?b="featureRatio":a.startsWith("EmethR")?
b="featureRatio":a.startsWith("EmethCpG")?b="featureRatio":a.startsWith("Enbh:")?b="featureNeighborhood":a.startsWith("GO:")?b="featureTable":a.startsWith("GENENAME:")?b="featureTable":a.startsWith("OMIM:")?b="featureTable":a.startsWith("regionList:")&&(b="featureRegionsList");return b}
function getTissueDescription(a){var b={NHLF:"NHLF (Normal Lung Fibroblasts)",NHEK:"NHEK (Normal Epidermal Keratinocytes)",K562:"K562 (Leukemia)",HUVEC:"HUVEC (Umbilical Vein Endothelial Cell)",NSMM:"NSMM (Normal Skeletal Muscle Myoblasts)",HMEC:"HMEC (Mammary Epithelial Cells)",HepG2:"HepG2 (Liver Carcinoma)",H1hESC:"H1-hESC (Human Embryonic Stem Cells)",GM12878:"GM12878 (Lymphoblastoid)"};return b[a]!==void 0?b[a]:a};function getQuery(a,b,c){var e=[],f="span.nonExistingClass";c=="main"?f="span.queryPrefixRaw":c=="ref"?f="span.referencePrefixRaw":alert("Invalid query type "+c);$(f).each(function(){e.push($(this).text())});return getQueryFromParts(a,b,e)}
function getQueryFromParts(a,b,c){var e="",f="",d="",g=[];$.each(c,function(b,c){c.charAt(0)=="-"?e=e.length>0?e+a+c:c:c.charAt(0)=="["?g.push(c.replace(/ /g,a)):f=f.length>0?f+a+c:c});f.length>0?(d=f,b.length>0&&(d=d+a+b),e.length>0&&(d=d+a+e)):d=e.length>0?b.length>0?b+a+e:"Eregion"+a+e:b;g.length>0&&(d=d.length>0?g.join(a)+a+d:g.join(a));return d=d.replace(/OVERLAP/g,settings.overlap).replace(/TISSUE/g,settings.tissue)}
function getQueryComplexJoin(a,b,c,e,f){for(var f=f.length>0?f+a+e:e,b=getQuery(a,b.length>0?b+a+e:e,"main"),e=[],d=b.indexOf("[");d>-1;){var g=b.indexOf("]");e.push(b.substring(d,g+1));var h="";d>0&&(h=b.substring(0,d-1));g<b.length-1&&(h+=b.substring(g+2));b=h;d=b.indexOf("[")}query="["+b+"%23"+f+"]";c!=""&&(query=query+a+c);e.length>0&&(query=e.join(a)+a+query);return query}
function selectCast(){$("td.castItem b").hide();$("td.castItem a").show();$(this).hide();$(this).siblings("b").show();$("#castFrame").attr("src",$(this).siblings("input:hidden")[0].value)}function removeUserDatasetFromLists(a){a=jQuery.inArray(a,currentState.userDatasets);a!=-1&&(currentState.userDatasets.splice(a,1),$.cookie("cgs:settings:userdatasets:"+settings.genome,currentState.userDatasets.join(";"),{expires:30}))}
function addUserDatasetRow(a){var b=$('<tr class="regionsButton regionsButtonHover regionUser" title="See more information"></tr>');b.append($('<input type="hidden" value="'+a+'"/>'));var c=$('<td title="Remove this custom dataset" class="removeUserDataset hoverChangeIcon"><img src="extras/edit-clear-locationbar-ltr.png" class="removeDatasetIcon"/><input type="hidden" value="'+a+'"/></td>');c.click(function(a){a.stopPropagation();var a=$(this).parent(),b=a.children("input:hidden").val();removeUserDatasetFromLists(b);
a.remove()});b.append(c);b.append($('<td class="regionsetSelectButton" align="left" title="Explore this dataset">'+currentState.datasetInfo[a].officialName+"</td>"));b.append($('<td class="regionsetSelectButton" align="right" title="Explore this dataset"> '+numberWithCommas(currentState.datasetInfo[a].numberOfRegions)+" </td>"));b.append($('<td align="center" class="regionsetSelectButton hoverChangeIcon" title="Explore this dataset"><img src="extras/media-playback-start.png" class="selectDatasetIcon"></img><div class="selectDatasetText">Select</div></td>'));
$("#regionsTable").prepend(b)}
function activateUserDatasetFunction(a,b,c,e){a=="Paste here a dataset ID and press enter"?b&&($(".activateUserDatasetSpan").show(),$(".activateUserDatasetSpan").text("You need to enter a dataset ID, first").fadeOut(2E3,function(){})):a==""?b&&($(".activateUserDatasetSpan").show(),$(".activateUserDatasetSpan").text("Please, insert a valid user dataset ID").fadeOut(4E3,function(){$(".activateUserDatasetSpan").text("")})):(b==true&&($(".activateUserDatasetSpan").show(),$(".activateUserDatasetSpan").text("Activating the dataset..")),
$.ajax({type:"GET",url:"relay.php",async:c,dataType:"json",data:"type=activateUserDataset&datasetID="+a,success:function(c){c[0]==1?(removeUserDatasetFromLists(a),b==true&&($(".activateUserDatasetSpan").show(),$(".activateUserDatasetSpan").text(c[1]))):(b==false?(currentState.datasetInfo[a]=c[2],e&&addUserDatasetRow(a)):$(".activateUserDatasetSpan").text(c[1]).fadeOut(2E3,function(){$(".activateUserDatasetSpan").text("");currentState.datasetInfo[a]=c[2];e&&addUserDatasetRow(a);showInfoRegionSet(a,
true);currentState.exploreRegionSelected=a;updateCurrentSelectionOverlapPlot(false)}),jQuery.inArray(a,currentState.userDatasets)==-1&&(currentState.userDatasets.push(a),$.cookie("cgs:settings:userdatasets:"+settings.genome,currentState.userDatasets.join(";"),{expires:30})))}}))}
function updateResultsAndDocuments(a,b){if(a||b){var c=getQuery(" ","Eregion","main");nh=0;a&&(nh=10);answerQuery(currentState.exploreRegionSelected,c,0,nh,true,"",function(c){a&&updateResults(c);b&&updateNumberOfDocuments(c)})}}
function updateOpenFeature(a,b,c){showInfoPlot("nodescription");$("#openedFeatureResults tr").remove();$("#openedFeatureResults div.featureRangeOrRatioResults").remove();$("#openedFeatureResults").append($('<div class="featureRangeOrRatioResults"></div>'));b&&$(".featureBoxOpened").each(function(){var a=$(this).children("input:hidden"),c=a[0].value;if(currentState.featuresElements[c]!==void 0)currentState.featureCurrentVisualization=c,$("#currentLinkLocation").text("");var d=a[1].value,g=[c];d=="featureRange"||
d=="featureRatio"||d=="featureNeighborhood"?(g.push(a[2].value),g.push(a[3].value)):d=="featureTable"?(g.push(a[2].value),g.push(a[3].value),g.push(a[4].value),g.push(true)):d=="featureTable"&&(g=["Eregion"]);var a=currentState.exploreRegionSelected,c=d!="featureTable"?c.charAt(0)=="-"?getQuery(" ",c.substr(1)+"*","main"):getQuery(" ",c+"*","main"):getQueryComplexJoin(" ","Eregion",g[1],g[2],g[3]),h=0,i=0,j="";b&&(d=="featureText"?(h=40,j="rw=3a"):d=="featureRange"?h=1E3:d=="featureRatio"?h=1E3:d==
"featureNeighborhood"?h=1500:d=="featureTable"?g[0].startsWith("GENENAME")?i=200:g[0].startsWith("GO:ALL")?(h=100,j="rw=1d"):g[0].startsWith("GO:TERMS")?h=200:g[0].startsWith("OMIM:ALL")?(h=100,j="rw=1d"):g[0].startsWith("OMIM:TERMS")&&(h=200):d=="featureRegionsList"&&(h=300,i=200));updateOpenedFeatureCore(d,a,c,h,i,j,g)});updateResultsAndDocuments(a,c)}
function updateOpenedFeatureCore(a,b,c,e,f,d,g){answerQuery(b,c,e,f,true,d,function(b){a=="featureText"?updateOpenedFeatureTable(b,g):a=="featureRange"?updateOpenedFeatureRange(b,g):a=="featureRatio"?updateOpenedFeatureRatio(b,g):a=="featureNeighborhood"?updateOpenedFeatureNeighborhood(b,g):a=="featureRegionsList"?updateOpenedFeatureRegionsList(b,g):a=="featureTable"&&updateOpenedFeatureJTable(b,g)})}
function updateResults(a){$(".progress_image_hits").remove();var b=0;$.each(a[4],function(a){b+=1;var a=a.split("_"),e="http://genome.ucsc.edu/cgi-bin/hgTracks?db="+settings.genome+"&position="+a[a.length-3]+"%3A"+a[a.length-2]+"-"+a[a.length-1];$("#resultsHitsListing > p").append($('<a href="'+e+'" target="_blank">'+a[a.length-3]+" "+a[a.length-2]+" "+a[a.length-1]+"</a><br>"))});b<10?$("#resultsHitsListing > p").prepend($("<h4>All "+b+" results</h4>")):($("#resultsHitsListing > p").prepend($("<h4>First 10 results</h4>")),
a=$('<div class="exportRegionsButton">Export all</div>'),a.button(),$("#resultsHitsListing > p").append(a))}
function updateCurrentSelectionOverlapPlotOnlyPlotGoogle(){var a={cols:[{label:"Annotation",type:"string"}],rows:[]},b=800,c=10;currentState.overlapSelection.length>12&&(c=9,b=1E3);var e;e=currentState.featureCurrentVisualization==""?"Summary of "+numberWithCommas(currentState.totalNumberOfRegions)+" "+currentState.datasetInfo[currentState.exploreRegionSelected].officialName:getTextForFeatureGroup(currentState.featureCurrentVisualization)+" summary of "+numberWithCommas(currentState.totalNumberOfRegions)+
" "+currentState.datasetInfo[currentState.exploreRegionSelected].officialName;b={width:b,height:350,title:e,legend:"top",hAxis:{maxAlternation:1,textStyle:{fontName:"Tahoma",fontSize:c},slantedText:false,slantedTextAngle:10,showTextEvery:1},vAxis:{title:"Percent of overlapping regions",format:"#,###%",minValue:0,maxValue:1},chartArea:{left:60,top:70,width:b-60}};currentState.referenceQuery.genome!=""?(a.cols.push({label:"Current selection ("+numberWithCommas(currentState.totalNumberOfRegions)+")",
type:"number"}),a.cols.push({label:"Reference ("+numberWithCommas(currentState.referenceQuery.totalNumber)+")",type:"number"}),b.colors=["#FA9627","#999999"]):(a.cols.push({label:"Current selection",type:"number"}),b.legend="none",b.colors=["#FA9627"]);$.each(currentState.overlapSelection,function(b,c){var f=c.replace(/OVERLAP/g,settings.overlap).replace(/TISSUE/g,settings.tissue);if(overlapLabels[f]!=void 0){row=[];row.push({v:overlapLabels[f]});if(currentState.currentOverlaps[f]!==void 0){var e=
currentState.currentOverlaps[f]/currentState.totalNumberOfRegions;row.push({v:e,f:numberWithCommas(currentState.currentOverlaps[f])+" ("+Math.round(e*1E3)/10+"%)"})}else row.push({v:0,f:0});currentState.referenceQuery.genome!=""&&(currentState.referenceQuery.values[f]!==void 0?(e=currentState.referenceQuery.values[f]/currentState.referenceQuery.totalNumber,row.push({v:e,f:numberWithCommas(currentState.referenceQuery.values[f])+" ("+Math.round(e*1E3)/10+"%)"})):row.push({v:0,f:0}));a.rows.push({c:row})}});
var c=new google.visualization.DataTable(a,0.6),f=new google.visualization.ChartWrapper({chartType:"ColumnChart",containerId:"rangeFeaturePlot",dataTable:c,options:b});f.draw();c=$('<tr class="showTableLink"><td colspan="2"><a href="#" onclick="return false">Show as table</a></td></tr>');c.click(function(){f.getChartType()=="Table"?(f.setChartType("ColumnChart"),f.setOption("height",350),$(".showTableLink a").text("Show as table"),$("tr.toPNGRow").show()):(f.setChartType("Table"),f.setOption("height",
null),$(".showTableLink a").text("Show as chart"),$("tr.toPNGRow").hide());f.draw()});$(".showTableLink").remove();$("#rangeFeaturePlotTable").append(c);$("tr.toPNGRow").remove();b=$('<tr class="toPNGRow"><td class="toPNGButton"><a href="#" onclick="return false">To PNG</a><input type="hidden" value="'+b.width+'"/> <input type="hidden" value="'+b.height+'"/><input type="hidden" value="'+f.getContainerId()+'"/></td></tr>');$("#rangeFeaturePlotTable").append(b)}
function updateCurrentSelectionOverlapPlot(a){closeOpenFeatureBox();showInfoPlot("nodescription");$("#rangeFeaturePlotMain").children().remove();$("#rangeFeaturePlotMain").show();$("#rangeFeaturePlotMain").append($('<table id="rangeFeaturePlotTable"><tr><td colspan="2"><div id="rangeFeaturePlot"></div></td></tr></table>'));currentState.overlapSelection.join("_").search("OVERLAP")>-1&&($("#rangeFeaturePlotTable").append('<tr><td>Select overlap criterion:</td><td><select id="overlapSelect"><option value="Eoverlaps">Any overlap (at least 1bp)</option><option value="Eoverlaps10p">Medium overlap (at least 10%)</option><option value="Eoverlaps50p">Strong overlap (at least 50%)</option></select></td></tr>'),
$("#overlapSelect").val(settings.overlap));currentState.overlapSelection.join("_").search("TISSUE")>-1&&($("#rangeFeaturePlotTable").append('<tr><td>Select tissue:</td><td><select id="tissueSelect"></select></td></tr>'),$.each(settings.defaultTissues,function(a,b){$("#tissueSelect").append($('<option value="'+b+'">'+getTissueDescription(b)+"</option>"))}),$("#tissueSelect").val(settings.tissue));if(a||currentState.currentOverlaps==settings.defaultCurrentOverlaps){var a=currentState.exploreRegionSelected,
b=getQuery(" ","Eregion","main");answerQuery(a,b,0,0,true,"",updateNumberOfDocuments);b=getQuery(" ",settings.overlap+":*","main");$(".visualization").append($('<img name="progress_image_feature_plot" src="extras/ajax-loader-big.gif" class="progress_image_feature_plot" align="center"></img>'));answerQuery(a,b,settings.maxOverlapCompletions,0,true,"",function(a){currentState.currentOverlaps={};totalNumber=parseInt(a[2],10);$.each(a[3],function(a,b){b=parseInt(b,10);currentState.currentOverlaps[a]=
b});currentState.referenceQuery.genome!=""?(referenceQuery=currentState.referenceQuery.query.replace(/BASEREFQUERY/g,settings.overlap+":*"),answerQuery(currentState.referenceQuery.dataset,referenceQuery,1500,0,true,"",function(a){$.each(a[3],function(a,b){b=parseInt(b,10);currentState.referenceQuery.values[a]=b});updateCurrentSelectionOverlapPlotOnlyPlotGoogle();$(".progress_image_feature_plot").remove()})):(updateCurrentSelectionOverlapPlotOnlyPlotGoogle(),$(".progress_image_feature_plot").remove())})}else updateCurrentSelectionOverlapPlotOnlyPlotGoogle()}
function updateOpenedFeatureNeighborhood(a,b){var c={},e={},f={};$.each(a[3],function(a,b){var d=a.split(":");c[d[4]]==void 0&&(c[d[4]]={});c[d[4]][d[3]]==void 0&&(c[d[4]][d[3]]={});c[d[4]][d[3]][d[2]]=[b,0];e[d[2]]=true;f[d[3]]=true});currentState.referenceQuery.genome!=""&&(referenceQuery=currentState.referenceQuery.query.replace(/BASEREFQUERY/g,b[0]+"*"),answerQuery(currentState.referenceQuery.dataset,referenceQuery,1500,0,false,"",function(a){$.each(a[3],function(a,b){var d=a.split(":");c[d[4]]==
void 0&&(c[d[4]]={});c[d[4]][d[3]]==void 0&&(c[d[4]][d[3]]={});c[d[4]][d[3]][d[2]]=c[d[4]][d[3]][d[2]]!==void 0?[c[d[4]][d[3]][d[2]][0],b]:[0,b];e[d[2]]=true;f[d[3]]=true})}));var d=[];$.each(e,function(a){d.push(a)});var g=[];$.each(f,function(a){g.push(a)});g.sort();var h="",i=[],j=[],l={},k=0,m=[];$.each(b[1].split(":"),function(a,b){m.push("0".repeat(6-b.length)+b)});m.sort();m.reverse();$.each(m,function(a,b){var c=parseInt(b,10);j.push("start - "+parseInt(c,10));l["bs"+c]=k;k+=1});var o=b[2].split(":"),
o=[];$.each(b[2].split(":"),function(a,b){o.push("0".repeat(6-b.length)+b)});o.sort();$.each(o,function(a,b){var c=parseInt(b,10);j.push("end + "+c);l["ae"+c]=k;k+=1});if(!(d.length>1)){var n=d[0],h=n+" neighborhood for "+currentState.datasetInfo[currentState.exploreRegionSelected].officialName;$.each(j,function(a,b){var c=[{v:b}];$.each(g,function(){c.push({v:0,f:"0 cases"})});currentState.referenceQuery.genome!=""&&$.each(g,function(){c.push({v:0,f:"0 cases"})});i.push({c:c})});$.each(c,function(a,
b){$.each(g,function(c,f){if(b[f]!==void 0)if(b[f][n]!==void 0){var d=parseInt(b[f][n][0],10);i[l[a]].c[c+1]={v:d/currentState.totalNumberOfRegions,f:d+" cases"}}else alert("No histone mark "+n+" data for tissue "+f)});currentState.referenceQuery.genome!=""&&$.each(g,function(c,f){if(b[f]!==void 0)if(b[f][n]!==void 0){var d=parseInt(b[f][n][1],10);i[l[a]].c[g.length+c+1]={v:d/currentState.referenceQuery.totalNumber,f:d+" cases"}}else alert("No histone mark "+n+" data for tissue "+f)})})}currentState.referenceQuery.genome==
""?updateOpenedFeatureNeighborhoodGooglePlotSingle(h,i,g):updateOpenedFeatureNeighborhoodGooglePlotReference(h,i,g);$(".progress_image_feature").remove();$(".progress_image_feature_plot").remove()}
function updateOpenedFeatureNeighborhoodGooglePlotReference(a,b,c){function e(f){var d=[{type:"string",label:"Position relative to the "+currentState.datasetInfo[currentState.exploreRegionSelected].officialName},{type:"number",label:c[f]+" (Current selection "+numberWithCommas(currentState.totalNumberOfRegions)+")"},{type:"number",label:c[f]+" (Reference "+numberWithCommas(currentState.referenceQuery.totalNumber)+")"}],e=[];$.each(b,function(a,b){e.push({c:[b.c[0],b.c[f+1],b.c[c.length+f+1]]})});
var h=new google.visualization.DataTable({cols:d,rows:e},0.6),d={title:a,width:750,legend:"top",height:g,vAxis:{title:"Percent of cases",format:"###.##%"},pointSize:5,hAxis:{title:"Relative position",showTextEvery:1,slantedText:1,slantedTextAngle:20},chartArea:{left:60,width:690},colors:["#FA9627","#999999"]};i=new google.visualization.ChartWrapper({chartType:"LineChart",containerId:"rangeFeaturePlot",dataTable:h,options:d});i.draw();h=$('<tr class="showTableLink"><td></td><td ><a href="#" onclick="return false">Show as table</a></td></tr>');
h.click(function(){i.getChartType()=="Table"?(i.setChartType("LineChart"),i.setOption("height",g),$(".showTableLink a").text("Show as table"),$("tr.toPNGRow").show()):(i.setChartType("Table"),i.setOption("height",null),$(".showTableLink a").text("Show as chart"),$("tr.toPNGRow").hide());i.draw()});$(".showTableLink").remove();$("#rangeFeaturePlotTable").append(h);$("tr.toPNGRow").remove();d=$('<tr class="toPNGRow"><td class="toPNGButton"><a href="#" onclick="return false">To PNG</a><input type="hidden" value="'+
d.width+'"/> <input type="hidden" value="'+d.height+'"/><input type="hidden" value="'+i.getContainerId()+'"/></td></tr>');$("#rangeFeaturePlotTable").append(d)}$("#rangeFeaturePlotMain").children().remove();$("#rangeFeaturePlotMain").show();showInfoPlot("neighborhoodref");$("#rangeFeaturePlotMain").append($('<table id="rangeFeaturePlotTable"><tr><td><div id="neighborhoodReferencetissueSelectionTable"></div></td><td><div id="rangeFeaturePlot"></div></td></tr></table>'));var f=[];$.each(c,function(a,
b){f.push({c:[{v:b}]})});var d=new google.visualization.DataTable({cols:[{label:"Select tissue",type:"string"}],rows:f},0.6),g=400,h=new google.visualization.ChartWrapper({chartType:"Table",containerId:"neighborhoodReferencetissueSelectionTable",dataTable:d,options:{width:100,height:g}});h.draw();var i;e(0);google.visualization.events.addListener(h,"select",function(){var a=h.getChart().getSelection()[0];a.row!=null&&e(a.row)})}
function updateOpenedFeatureNeighborhoodGooglePlotSingle(a,b,c){$("#rangeFeaturePlotMain").children().remove();$("#rangeFeaturePlotMain").show();showInfoPlot("neighborhoodsingle");$("#rangeFeaturePlotMain").append($('<table id="rangeFeaturePlotTable"><tr><td colspan="2"><div id="rangeFeaturePlot"></div></td></tr></table>'));var e=[];e.push({type:"string",label:"Position relative to the "+currentState.datasetInfo[currentState.exploreRegionSelected].officialName});$.each(c,function(a,b){e.push({type:"number",
label:b})});var f=new google.visualization.DataTable({cols:e,rows:b},0.6),d={title:a,width:800,height:400,legend:"top",vAxis:{title:"Percent of cases",format:"###.##%"},pointSize:5,hAxis:{title:"Relative position",showTextEvery:1,slantedText:1,slantedTextAngle:20},chartArea:{left:60,width:740}},g=new google.visualization.ChartWrapper({chartType:"LineChart",containerId:"rangeFeaturePlot",dataTable:f,options:d});google.visualization.events.addListener(g,"select",function(){var a=g.getChart().getSelection()[0];
a.column!=null&&(f.removeColumn(a.column),g.draw(f,d))});g.draw();a=$('<tr class="showTableLink"><td ><a href="#" onclick="return false">Show as table</a></td><td></td></tr>');a.click(function(){g.getChartType()=="Table"?(g.setChartType("LineChart"),g.setOption("height",400),$(".showTableLink a").text("Show as table"),$("tr.toPNGRow").show()):(g.setChartType("Table"),g.setOption("height",null),$(".showTableLink a").text("Show as chart"),$("tr.toPNGRow").hide());g.draw()});$(".showTableLink").remove();
$("#rangeFeaturePlotTable").append(a);$("tr.toPNGRow").remove();a=$('<tr class="toPNGRow"><td class="toPNGButton"><a href="#" onclick="return false">To PNG</a><input type="hidden" value="'+d.width+'"/> <input type="hidden" value="'+d.height+'"/><input type="hidden" value="'+g.getContainerId()+'"/></td></tr>');$("#rangeFeaturePlotTable").append(a)}
function updateOpenedFeatureRatio(a,b){updateOpenedFeatureRatioLines(a,b);$(".progress_image_feature").remove();$(".progress_image_feature_plot").remove()}
function updateOpenedFeatureRatioLines(a,b){var c=function(a){return convertRatioToNumber(a,b[1])},e=[],f={},d=Math.pow(10,b[1]),g=0;$.each(a[3],function(a,b){var c=parseInt(b,10),h=a.split(":").pop(),i=parseInt(h,10);d>i&&(d=i);g<i&&(g=i);e[i]=c;f[h]=[c,0]});var h=d,i=g;currentState.referenceQuery.genome!=""&&(referenceQuery=currentState.referenceQuery.query.replace(/BASEREFQUERY/g,b[0]+"*"),answerQuery(currentState.referenceQuery.dataset,referenceQuery,1500,0,false,"",function(a){$.each(a[3],function(a,
b){var d=parseInt(b,10),e=a.split(":").pop(),g=parseInt(e,10);h>g&&(h=g);i<g&&(i=g);c(g);currentState.referenceQuery.values[g]=d;f[e]=f[e]!==void 0?[f[e][0],d]:[0,d]})}));if(e.length>0)e.length==1||d==g?updateOpenedFeatureTableLines(a,"",b,false):updateOpenedFeatureRatioSlider(e,d,g,c,b),updateOpenedFeatureRatioPlotGoogle(f,c,b);else{$("#rangeFeaturePlotMain").children().remove();$("#rangeFeaturePlotMain").show();$("#rangeFeaturePlotMain").append($('<table id="rangeFeaturePlotTable"><tr style="width:100%;"><td align="left">No regions fit this query</td><td></td></tr></table>'));
var j=$('<tr style="width:100%;"><td ></td><td align="left">No regions fit this query</td><td align="right"></td></tr>');$("#openedFeatureResults").append(j)}}
function updateOpenedFeatureRatioPlotGoogle(a,b,c){$("#rangeFeaturePlotMain").children().remove();$("#rangeFeaturePlotMain").show();showInfoPlot("ratio");$("#rangeFeaturePlotMain").append($('<table id="rangeFeaturePlotTable"><tr><td colspan="2"><div id="rangeFeaturePlot"></div></td></tr></table>'));var e={cols:[{label:"ORatio",type:"string"},{label:"Current selection",type:"number"}],rows:[]},f=Object.keys(a);f.sort();var d=null;$.each(f,function(c,f){var g=parseInt(f,10),l=b(g),k=a[f];if(d!=null&&
g>d+1)for(var m=d+1;m<g;m++){var o=b(m);currentState.referenceQuery.genome!=""?e.rows.push({c:[{v:o},{v:0,f:"0 cases"},{v:0,f:"0 cases"}]}):e.rows.push({c:[{v:o},{v:0,f:"0 cases"}]})}d=g;b(g+1);g={v:0};k[0]!=null&&(g={v:k[0]/currentState.totalNumberOfRegions,f:k[0]+" cases"});currentState.referenceQuery.genome!=""?(m={v:0},k[1]!=null&&(m={v:k[1]/currentState.referenceQuery.totalNumber,f:k[1]+" cases"}),e.rows.push({c:[{v:l},g,m]})):e.rows.push({c:[{v:l},g]})});c={width:850,height:400,chartArea:{left:60,
width:740,right:50},hAxis:{title:getTextForFeaturePrefix(c[0])},vAxis:{title:"Percent of cases",format:"###.##%",viewWindowMode:"pretty"},pointSize:6};currentState.referenceQuery.genome!=""?(e.cols.push({label:"Reference",type:"number"}),c.legend="top",c.colors=["#FA9627","#999999"]):(c.legend="none",c.colors=["#AAAAAA"]);f=new google.visualization.DataTable(e,0.6);c.hAxis.showTextEvery=Math.round(e.rows.length/10);c.hAxis.maxAlternation=1;c.hAxis.textStyle={fontSize:10};c.hAxis.slantedText=false;
c.pointSize=1;var g=new google.visualization.ChartWrapper({chartType:"AreaChart",containerId:"rangeFeaturePlot",dataTable:f,options:c});g.draw();f=$('<tr class="showTableLink"><td ><a href="#" onclick="return false">Show as table</a></td><td></td></tr>');f.click(function(){g.getChartType()=="Table"?(g.setChartType("AreaChart"),g.setOption("height",400),$(".showTableLink a").text("Show as table"),$("tr.toPNGRow").show()):(g.setChartType("Table"),g.setOption("height",null),$(".showTableLink a").text("Show as chart"),
$("tr.toPNGRow").hide());g.draw()});$(".showTableLink").remove();$("#rangeFeaturePlotTable").append(f);$("tr.toPNGRow").remove();c=$('<tr class="toPNGRow"><td class="toPNGButton"><a href="#" onclick="return false">To PNG</a><input type="hidden" value="'+c.width+'"/> <input type="hidden" value="'+c.height+'"/><input type="hidden" value="'+g.getContainerId()+'"/></td><td></td></tr>');$("#rangeFeaturePlotTable").append(c)}
function updateOpenedFeatureRange(a,b){updateOpenedFeatureRangeLines(a,b);$(".progress_image_feature").remove();$(".progress_image_feature_plot").remove()}
function updateOpenedFeatureRangeLines(a,b){var c=function(a){return convertRangeToNumber(a,b[1],b[2])},e=[],f={},d={},g={},h={},i=1E3,j=0;$.each(a[3],function(a,h){var k=parseInt(h,10),l=a.split(":").pop(),n=parseInt(l,10);if(g[l[0]]!==void 0)g[l[0]][1]+=k;else{var m=l[0]+"1"+"0".repeat(b[1]-2),o=l[0]+"9".repeat(b[1]-1),m="Between "+numberWithCommas(c(m))+" and "+numberWithCommas(c(o));g[l[0]]=[m,k];d[m]=[]}i>n&&(i=n);j<n&&(j=n);e[n]=k;f[l]=g[l[0]][0]});var l=parseInt(a[2],10),k=1;currentState.referenceQuery.genome!=
""&&($.each(g,function(a,b){b.push(0);g[a]=b}),referenceQuery=currentState.referenceQuery.query.replace(/BASEREFQUERY/g,b[0]+"*"),answerQuery(currentState.referenceQuery.dataset,referenceQuery,1500,0,false,"",function(a){$.each(a[3],function(a,e){var h=parseInt(e,10),i=a.split(":").pop(),j=parseInt(i,10);if(g[i[0]]!==void 0)g[i[0]][2]+=h;else{var l=i[0]+"1"+"0".repeat(b[1]-2),k=i[0]+"9".repeat(b[1]-1),l="Between "+numberWithCommas(c(l))+" and "+numberWithCommas(c(k));g[i[0]]=[l,0,h];d[l]=[]}currentState.referenceQuery.values[j]=
h;f[i]=g[i[0]][0]});k=parseInt(a[2],10);h={cols:[{label:"Range",type:"string"}],rows:[{c:[{v:"Current selection ("+l+")"}]},{c:[{v:"Reference ("+k+")"}]}]};a=Object.keys(g);a.sort();$.each(a,function(a,b){var c=g[b];h.cols.push({label:c[0]+"",type:"number",id:b[0]+""});h.rows[0].c.push({v:c[1]/l,f:c[1]+""});h.rows[1].c.push({v:c[2]/k,f:c[2]+""})})}));var m=Object.keys(f);m.sort();var o=null,n=0;$.each(m,function(a,b){var g=parseInt(b,10),h=f[b];if(h==o&&n+1<g)for(var i=n+1,i=n+1;i<g;i++){var j=c(i);
currentState.referenceQuery.genome!=""?d[h].push([{v:j+""},0,0]):d[h].push([{v:j+""},0])}o=h;n=g;i=c(parseInt(g,10));c(parseInt(g,10)+1);if(currentState.referenceQuery.genome!=""){j=0;e[g]!==void 0&&(j={v:e[g]/l,f:e[g]+" cases"});var m=0;currentState.referenceQuery.values[g]!==void 0&&(m={v:currentState.referenceQuery.values[g]/k,f:currentState.referenceQuery.values[g]+" cases"});d[h].push([{v:i+""},j,m])}else j=0,e[g]!==void 0&&(j={v:parseInt(e[g],10)/l,f:e[g]+" cases"}),d[h].push([{v:i+""},j])});
if(e.length>0)if(i==j?updateOpenedFeatureTableLines(a,"",b,false):updateOpenedFeatureRangeSlider(e,i,j,c,b),currentState.referenceQuery.genome!="")updateOpenedFeatureRangePlotColumn(h,d,b,c);else{var q=[],m=Object.keys(g);m.sort();$.each(m,function(a,b){q.push(g[b])});updateOpenedFeatureRangePlotPie(q,d,b,c)}else $("#rangeFeaturePlotMain").children().remove(),$("#rangeFeaturePlotMain").show(),$("#rangeFeaturePlotMain").append($('<table id="rangeFeaturePlotTable"><tr style="width:100%;"><td align="left">No regions fit this query</td><td></td></tr></table>')),
m=$('<tr style="width:100%;"><td ></td><td align="left">No regions fit this query</td><td align="right"></td></tr>'),$("#openedFeatureResults").append(m)}
function updateOpenedFeatureRangePlotColumn(a,b,c){$("#rangeFeaturePlotMain").children().remove();$("#rangeFeaturePlotMain").show();showInfoPlot("rangecolumn");$("#rangeFeaturePlotMain").append($('<table id="rangeFeaturePlot"><tr><td><div id="rangeFeaturePlotPie" ></div></td><td><div id="rangeFeaturePlotScatter" ></div></td></tr></table>'));var e=new google.visualization.DataTable(a,0.6),a={width:450,height:400,title:getTextForFeaturePrefix(c[0]),isStacked:true,enableInteractivity:true,legend:"top",
chartArea:{left:50,width:400},vAxis:{format:"###.##%"},legendTextStyle:{fontSize:9}},f=new google.visualization.ChartWrapper({chartType:"ColumnChart",containerId:"rangeFeaturePlotPie",dataTable:e,options:a});f.draw();google.visualization.events.addListener(f,"select",function(){for(var a=f.getChart().getSelection(),d=0;d<a.length;d++){var g=a[d];g.row!=null&&g.column!=null?message=e.getColumnLabel(g.column):g.row!=null?message="":g.column!=null&&(message=e.getColumnLabel(g.column))}b[message]!==void 0&&
updateOpenedFeatureRangePlotGoogle(b[message],c)});var d=$('<tr class="showTableLink"></tr>'),g=$('<td><a href="#" onclick="return false">Show as table</a></td>');g.click(function(){f.getChartType()=="Table"?(f.setChartType("ColumnChart"),f.setOption("height",400),$(".showTableLink td:eq(0) a").text("Show as table"),$("tr.toPNGRow td:eq(0) ").show()):(f.setChartType("Table"),f.setOption("height",null),$(".showTableLink td:eq(0) a").text("Show as chart"),$("tr.toPNGRow td:eq(0) a").hide());f.draw()});
$(".showTableLink").remove();$(d).append(g);$("#rangeFeaturePlot").append(d);$("tr.toPNGRow").remove();a=$('<tr class="toPNGRow"><td class="toPNGButton"><a href="#" onclick="return false">To PNG</a><input type="hidden" value="'+a.width+'"/> <input type="hidden" value="'+a.height+'"/><input type="hidden" value="'+f.getContainerId()+'"/></td></tr>');$("#rangeFeaturePlot").append(a);updateOpenedFeatureRangePlotGoogle(b[e.getColumnLabel(1)],c)}
function updateOpenedFeatureRangePlotPie(a,b,c){$("#rangeFeaturePlotMain").children().remove();$("#rangeFeaturePlotMain").show();showInfoPlot("rangepie");$("#rangeFeaturePlotMain").append($('<table id="rangeFeaturePlot"><tr><td><div id="rangeFeaturePlotPie" ></div></td><td><div id="rangeFeaturePlotScatter" ></div></td></tr></table>'));var e=new google.visualization.DataTable;e.addColumn("string","Range");e.addColumn("number","Number fo regions");e.addRows(a);var f={width:450,height:400,title:getTextForFeaturePrefix(c[0]),
legend:"right",sliceVisibilityThreshold:1.0E-4,chartArea:{left:0,width:450},is3D:true,legendTextStyle:{fontSize:10}},d=new google.visualization.ChartWrapper({chartType:"PieChart",containerId:"rangeFeaturePlotPie",dataTable:e,options:f});d.draw();google.visualization.events.addListener(d,"select",function(){for(var a=d.getChart().getSelection(),f="",g=0;g<a.length;g++){var h=a[g],f=e.getValue(h.row,0);e.getValue(h.row,1)}b[f]!==void 0&&updateOpenedFeatureRangePlotGoogle(b[f],c)});var g=$('<tr class="showTableLink"></tr>'),
h=$('<td><a href="#" onclick="return false">Show as table</a></td>');h.click(function(){d.getChartType()=="Table"?(d.setChartType("PieChart"),d.setOption("height",400),$("tr.showTableLink td:eq(0) a").text("Show as table"),$("tr.toPNGRow td:eq(0) a").show()):(d.setChartType("Table"),d.setOption("height",null),$("tr.showTableLink td:eq(0) a").text("Show as chart"),$("tr.toPNGRow td:eq(0) a").hide());d.draw()});$(".showTableLink").remove();$(g).append(h);$("#rangeFeaturePlot").append(g);$("tr.toPNGRow").remove();
f=$('<tr class="toPNGRow"><td class="toPNGButton"><a href="#" onclick="return false">To PNG</a><input type="hidden" value="'+f.width+'"/> <input type="hidden" value="'+f.height+'"/><input type="hidden" value="'+d.getContainerId()+'"/></td></tr>');$("#rangeFeaturePlot").append(f);updateOpenedFeatureRangePlotGoogle(b[a[0][0]],c)}
function updateOpenedFeatureRangePlotGoogle(a,b){var c=new google.visualization.DataTable,e={width:500,height:400,chartArea:{left:60,width:400,right:40},vAxis:{title:"Percent of cases",format:"###.##%"},hAxis:{title:getTextForFeaturePrefix(b[0]),showTextEvery:Math.round(a.length/5),textStyle:{fontSize:10},slantedText:false,maxAlternation:1},pointSize:5};currentState.referenceQuery.genome!=""?(c.addColumn("string","Length"),c.addColumn("number","Current selection"),c.addColumn("number","Reference"),
e.legend="top",e.colors=["#FA9627","#999999"]):(c.addColumn("string","Length"),c.addColumn("number","Current selection"),e.legend="none",e.colors=["#AAAAAA"]);c.addRows(a);var f=new google.visualization.ChartWrapper({chartType:"AreaChart",containerId:"rangeFeaturePlotScatter",dataTable:c,options:e});f.draw();var d=$('<td><a href="#" onclick="return false">Show as table</a></td>');d.click(function(){f.getChartType()=="Table"?(f.setChartType("AreaChart"),f.setOption("height",400),d.children("a").text("Show as table"),
$("tr.toPNGRow td:eq(1) a").show()):(f.setChartType("Table"),f.setOption("height",null),d.children("a").text("Show as chart"),$("tr.toPNGRow td:eq(1) a").hide());f.draw()});$("tr.showTableLink td:gt(0)").remove();$("tr.showTableLink").append(d);$("tr.toPNGRow td:eq(1)").remove();c=$('<td class="toPNGButton"><a href="#" onclick="return false">To PNG</a><input type="hidden" value="'+e.width+'"/> <input type="hidden" value="'+e.height+'"/><input type="hidden" value="'+f.getContainerId()+'"/></td>');
$("tr.toPNGRow").append(c)}
function updateOpenedFeatureRatioSlider(a,b,c,e,f){var e=$('<div><p id="featureRangeAmount"></p></div>'),d=$("<div></div>");d.slider({range:true,min:b,max:c,values:[b,c],slide:function(b,c){$("#featureRangeAmount").text(getReadableFeatureText(f[0]+c.values[0]+"--"+f[0]+c.values[1])+" for total of "+a.sum(c.values[0],c.values[1])+" hits")}});e.append(d);d=$('<span title="Filter to this selection" style="margin:5px;">Filter to this selection</span>');d.button();d.one("click",function(b){b.stopPropagation();
var b=parseInt($("#openedFeatureResults .ui-slider").slider("values",0),10),c=parseInt($("#openedFeatureResults .ui-slider").slider("values",1),10),c=a.searchSE(c),b=a.searchLE(b);if(f[2]!=0)b="0".repeat(f[2]-(b+"").length)+b,c="0".repeat(f[2]-(c+"").length)+c;else{if(b<100&&(f[1]==3||f[1]==0))b="0"+b;b<10&&(b="0"+b);if(c<100&&(f[1]==3||f[1]==0))c="0"+c;c<10&&(c="0"+c)}b=f[0]+b+"--"+f[0]+c;c=getReadableFeatureText(b);addResultsRefinementAndUpdate(c,b,-1,true)});e.append(d);$("#openedFeatureResults div.featureRangeOrRatioResults").append(e);
$("#featureRangeAmount").text(getReadableFeatureText(f[0]+b+"--"+f[0]+c)+" for total of "+a.sum(b,c)+" hits")}
function updateOpenedFeatureRangeSlider(a,b,c,e,f){var e=$('<div><p id="featureRangeAmount"></p></div>'),d=$("<div></div>");d.slider({range:true,min:b,max:c,values:[b,c],slide:function(b,c){if(c.values[0]==c.values[1])return false;$("#featureRangeAmount").text(getReadableFeatureText(f[0]+c.values[0]+"--"+f[0]+c.values[1])+" for total of "+a.sum(c.values[0],c.values[1])+" hits")}});e.append(d);d=$('<span title="Filter to this selection" style="margin:5px;">Filter to this selection</span>');d.button();
d.one("click",function(a){a.stopPropagation();a=parseInt($("#openedFeatureResults .ui-slider").slider("values",0),10);a<100&&f[1]==3&&(a="0"+a);a<10&&(a="0"+a);var b=$("#openedFeatureResults .ui-slider").slider("values",1);b<100&&f[1]==3&&(b="0"+b);b<10&&(b="0"+b);a=f[0]+a+"--"+f[0]+b;b=getReadableFeatureText(a);addResultsRefinementAndUpdate(b,a,-1,true)});e.append(d);$("#openedFeatureResults div.featureRangeOrRatioResults").append(e);$("#featureRangeAmount").text(getReadableFeatureText(f[0]+b+"--"+
f[0]+c)+" for total of "+a.sum(b,c)+" hits")}function updateOpenedFeatureJTable(a,b){updateOpenedFeatureJTableLines(a,b);$(".progress_image_feature").remove();$(".progress_image_feature_plot").remove()}
function updateOpenedFeatureJTableLines(a,b){var c=[];parseInt($("#totalDocuments").text().replace(/,/g,""),10);b[0].startsWith("GENENAME:")?c=updateOpenedFeatureJTableLinesGENENAMES(a,b):b[0].startsWith("GO:ALL")?c=updateOpenedFeatureJTableLinesGONAMES(a,b):b[0].startsWith("GO:TERMS")?c=updateOpenedFeatureJTableLinesTERMS(a,b,"selectGOterm",5):b[0].startsWith("OMIM:ALL")?c=updateOpenedFeatureJTableLinesOMIMNAMES(a,b):b[0].startsWith("OMIM:TERMS")&&(c=updateOpenedFeatureJTableLinesTERMS(a,b,"selectOMIMterm",
6));c.length>0?updateOpenedFeatureJTablePlot(a,c,b):(c=$('<tr style="width:100%;"><td ></td><td align="left">No results fit this query</td><td align="right"></td></tr>'),$("#openedFeatureResults tr").remove(),$("#openedFeatureResults").append(c),b[4]?($("#rangeFeaturePlotMain").children().remove(),$("#rangeFeaturePlotMain").children().remove(),rangePlot=$('<table id="rangeFeaturePlot"><tr><td><div id="rangeFeaturePlotTable" ></div></td><td><div id="rangeFeaturePlotTableCloud" ></div></td></tr><tr>No results fit this query</tr></table>'),
$("#rangeFeaturePlotMain").append(rangePlot)):($("#rangeFeaturePlot tr:gt(0)").remove(),$("#rangeFeaturePlot").append($('<tr><td><div id="rangeFeaturePlotTable" ></div></td><td><div id="rangeFeaturePlotTableCloud" ></div></td></tr>')),$("#rangeFeaturePlot").append($('<tr><td colspan="2">No results fit this query</td></tr>'))))}
function updateOpenedFeatureJTableLinesGONAMES(a){var b={};$.each(a[3],function(a,c){b[a.slice(4)]=parseInt(c,10)-1});var c=[];$.ajax({type:"POST",url:"relay.php",async:false,dataType:"json",data:{type:"getGeneExtraInfo",genome:settings.genome,infoType:"GO",elements:Object.keys(b)},success:function(a){$.each(a[0],function(a,d){var e=d[0],h='<a href="http://amigo.geneontology.org/cgi-bin/amigo/term_details?term='+a+'" target="_blank">'+a+"</a>",i=parseInt(d[2],10),j=parseFloat((b[a]/i).toPrecision(3));
c.push([h,b[a],i,e,j,'<div class="CGSicon ui-icon ui-icon-play ui-icon-turnred selectGOName" title="Use this refinement"></div>'])})}});return c}
function updateOpenedFeatureJTableLinesOMIMNAMES(a){var b={};$.each(a[3],function(a,c){b[a.slice(7)]=parseInt(c,10)-1});var c=[],c=[];$.ajax({type:"POST",url:"relay.php",async:false,dataType:"json",data:{type:"getGeneExtraInfo",genome:settings.genome,infoType:"OMIM",elements:Object.keys(b)},success:function(a){$.each(a[0],function(a,d){var e=d[0],h='<a href="http://www.ncbi.nlm.nih.gov/omim/'+a+'" target="_blank">OMIM ID:'+a+"</a>",i=parseInt(d[1],10),j=parseFloat((b[a]/i).toPrecision(3));c.push([h,
b[a],i,e,j,'<div class="CGSicon ui-icon ui-icon-play ui-icon-turnred selectOMIMName" title="Use this refinement"></div>'])})}});return c}
function updateOpenedFeatureJTableLinesGENENAMES(a){var b=[];$.each(a[4],function(a){var a=a.split(" "),e='<a href="http://may2009.archive.ensembl.org/Homo_sapiens/Gene/Summary?db=core;g='+a[1]+'" target="_blank">'+a[1]+"</a>",f=a.slice(3).join(" "),d=f.indexOf("[Source:"),f=d>-1?'<p title="'+f.substring(d)+'">'+f.substring(0,d)+"</p>":f;b.push([e,a[2],f,'<div class="CGSicon ui-icon ui-icon-play ui-icon-turnred selectGeneName" title="Use this refinement"></div>'])});return b}
function termConvert(a){return a.replace(/l/g,"+").replace(/d/g,"-").replace(/u/g,"_").replace(/r/g,"i")}function updateOpenedFeatureJTableLinesTERMS(a,b,c,e){var f=[];$.each(a[3],function(a,b){var h='<div class="CGSicon ui-icon ui-icon-play ui-icon-turnred '+c+'" title="Use this refinement"><input type="hidden" value="'+a+'"/>';f.push([termConvert(a.slice(e)).toLowerCase(),parseInt(b,10),h])});return f}
function updateOpenedFeatureJTablePlot(a,b,c){$("#openedFeatureResults tr").remove();var e;c[4]?($("#rangeFeaturePlotMain").children().remove(),e=$('<table id="rangeFeaturePlot"><tr><td><div id="rangeFeaturePlotTable" ></div></td><td><div id="rangeFeaturePlotTableCloud" ></div></td></tr></table>'),$("#rangeFeaturePlotMain").append(e)):(c[0].startsWith("GO:ALL")?$("#rangeFeaturePlot tr:gt(2)").remove():$("#rangeFeaturePlot tr:gt(1)").remove(),e=$("#rangeFeaturePlot"));a[0]=a[0].replace(/#/g,"%23");
var f=a[0].replace(/ /g,"::qq::"),d=new google.visualization.DataTable;c[0].startsWith("GENENAME:")?(d.addColumn("string","Ensembl ID"),d.addColumn("string","Gene symbol"),d.addColumn("string","Description"),d.addColumn("string","")):c[0].startsWith("GO:ALL")?(d.addColumn("string","GO"),d.addColumn("number","Number of regions"),d.addColumn("number","Number of genes"),d.addColumn("string","description"),d.addColumn("number","Ratio"),d.addColumn("string","")):c[0].startsWith("GO:TERMS")?(d.addColumn("string",
"Word"),d.addColumn("number","Number of GOs with such description"),d.addColumn("string","")):c[0].startsWith("OMIM:ALL")?(d.addColumn("string","OMIM"),d.addColumn("number","Number of regions"),d.addColumn("number","Number of genes"),d.addColumn("string","description"),d.addColumn("number","Ratio"),d.addColumn("string","")):c[0].startsWith("OMIM:TERMS")&&(d.addColumn("string","Word"),d.addColumn("number","Number of OMIMs with such description"),d.addColumn("string",""));d.addRows(b);var g={page:"enable",
height:null,pageSize:10,pagingButtonsConfiguration:"auto",sortColumn:1,sortAscending:false,showRowNumber:true,allowHtml:true},h=new google.visualization.ChartWrapper({chartType:"Table",containerId:"rangeFeaturePlotTable",dataTable:d,options:g});h.draw();var i;if(c[0].startsWith("GENENAME:")){i=$('<td colspan="2"> Showing info for '+b.length+" genes out of "+a[2]+" </td>");if(g.page=="enable"&&b.length>10){var j=$(' <a href="#" onclick="return false"> (Show all '+b.length+") </a> ");j.click(function(){h.setOption("page",
null);h.setOption("height","500px");h.draw();$(this).remove()});i.append(j)}j=false;$("#rangeFeaturePlotTableCloud").children().remove();$("#rangeFeaturePlotTableCloud").append($('<a href="relay.php?type=exportGenesAndSendBack&exportType=TABLE&regiontype='+currentState.exploreRegionSelected+"&query="+f+'" target="_blank"> Export all as table</a><br><br>'));$("#rangeFeaturePlotTableCloud").append($('<a href="relay.php?type=exportGenesAndSendBack&exportType=ENSEMBL&regiontype='+currentState.exploreRegionSelected+
"&query="+f+'" target="_blank"> Export all Ensembl identfiers</a><br><br>'));$("#rangeFeaturePlotTableCloud").append($('<a href="relay.php?type=exportGenesAndSendBack&exportType=SYMBOL&regiontype='+currentState.exploreRegionSelected+"&query="+f+'" target="_blank"> Export all gene symbols</a><br><br>'));f=$("<tr></tr>");f.append(i);e.append(f);i=autoCompleteCallbackGene;showInfoPlot("genes")}else c[0].startsWith("GO:ALL")?(j=new TermCloud(document.getElementById("rangeFeaturePlotTableCloud")),j.draw(d,
{numberColumnIndex:4,wordColumnIndex:3}),i=$('<td colspan="2">Showing top '+b.length+" GOs (by number of regions) out of "+numberWithCommas(a[1])+" </td>"),g.page=="enable"&&b.length>10&&(j=$(' <a href="#" onclick="return false"> (Show all '+b.length+") </a> "),j.click(function(){h.setOption("page",null);h.setOption("height","500px");h.draw();$(this).remove()}),i.append(j)),j=$(' <a href="relay.php?type=exportGOsAndSendBack&regiontype='+currentState.exploreRegionSelected+"&query="+f+'" target="_blank">Export all</a> '),
f=$("<tr></tr>"),f.append(i),e.append(f),c[4]&&(i=getQueryComplexJoin(" ","Eregion","gGONG:*","gGO:*","GOterm gGONG:000--gGONG:999"),answerQuery(currentState.exploreRegionSelected,i,1E3,0,false,"rw=3a",function(a){var b=[],c=999,d=0;$.each(a[3],function(a,f){var f=parseInt(f,10),e=parseInt(a.slice(6),10);b[e]=f;c>e&&(c=e);d<e&&(d=e)});if(b.length>0&&c<d){var a=function(){var a=$("select.minGenesOFGO option:selected").val(),b=$("select.maxGenesOFGO option:selected").val();if(a>b)return alert("The minimum value cannot be smaller than the maximum value"),
$("select.minGenesOFGO").val("001"),$("select.maxGenesOFGO").val("450"),false;$("#exampleAutocomplete").val("");a=["GO:ALL:","","gGO:*","GOterm gGONG:"+a+"--gGONG:"+b,false];b=getQueryComplexJoin(" ","Eregion",a[1],a[2],a[3]);updateOpenedFeatureCore("featureTable",currentState.exploreRegionSelected,b,100,0,"rw=1d",a)},f=$("<tr></tr>"),g=$("<td><label>Minimum number of genes associated with a GO term</label></td>");f.append(g);var i=$('<select class="minGenesOFGO"></select>');g.append(i);i.append($('<option value="001" selected="selected">1 (Min)</option>'));
i.append($('<option value="005">5</option>'));i.append($('<option value="110">10</option>'));i.append($('<option value="150">50</option>'));i.append($('<option value="210">100</option>'));i.append($('<option value="250">500</option>'));i.append($('<option value="310">1,000</option>'));i.append($('<option value="350">5,000</option>'));i.append($('<option value="450">Max</option>'));g=$("<td><label>Maximum number of genes associated with a GO term</label></td>");f.append(g);var h=$('<select class="maxGenesOFGO"></select>');
g.append(h);h.append($('<option value="001">1 (min)</option>'));h.append($('<option value="005">5</option>'));h.append($('<option value="110">10</option>'));h.append($('<option value="150">50</option>'));h.append($('<option value="210">110</option>'));h.append($('<option value="250">510</option>'));h.append($('<option value="310">1,100</option>'));h.append($('<option value="350">5,100</option>'));h.append($('<option value="450" selected="selected">30,000 (Max)</option>'));e.prepend(f);$(i).change(a);
$(h).change(a)}})),i=autoCompleteCallbackGOcategory,showInfoPlot("goterms")):c[0].startsWith("GO:TERMS")?(j=new TermCloud(document.getElementById("rangeFeaturePlotTableCloud")),j.draw(d,null),i=$('<td colspan="2">Showing the '+b.length+" most common words from the "+a[2]+" GO terms </td>"),g.page=="enable"&&b.length>10&&(j=$(' <a href="#" onclick="return false"> (Show all '+b.length+") </a> "),j.click(function(){h.setOption("page",null);h.setOption("height","500px");h.draw();$(this).remove()}),i.append(j)),
j=$('<a href="relay.php?type=exportGOTermsAndSendBack&regiontype='+currentState.exploreRegionSelected+"&query="+f+'" target="_blank"> Export all </a>'),f=$("<tr></tr>"),f.append(i),e.append(f),i=autoCompleteCallbackGOterm,showInfoPlot("gowords")):c[0].startsWith("OMIM:ALL")?(j=new TermCloud(document.getElementById("rangeFeaturePlotTableCloud")),j.draw(d,{numberColumnIndex:4,wordColumnIndex:3}),i=$('<td colspan="2">Showing top '+b.length+" OMIMs (by number of regions) out of "+numberWithCommas(a[1])+
" </td>"),g.page=="enable"&&b.length>10&&(j=$(' <a href="#" onclick="return false"> (Show all '+b.length+") </a> "),j.click(function(){h.setOption("page",null);h.setOption("height","500px");h.draw();$(this).remove()}),i.append(j)),j=$(' <a href="relay.php?type=exportOMIMsAndSendBack&regiontype='+currentState.exploreRegionSelected+"&query="+f+'" target="_blank">Export all</a> '),j=false,f=$("<tr></tr>"),f.append(i),e.append(f),i=autoCompleteCallbackOMIMcategory,showInfoPlot("omimterms")):c[0].startsWith("OMIM:TERMS")&&
(j=new TermCloud(document.getElementById("rangeFeaturePlotTableCloud")),j.draw(d,null),i=$('<td colspan="2">Showing the '+b.length+" most common words from the "+a[2]+" OMIM terms </td>"),g.page=="enable"&&b.length>10&&(j=$(' <a href="#" onclick="return false"> (Show all '+b.length+") </a> "),j.click(function(){h.setOption("page",null);h.setOption("height","500px");h.draw();$(this).remove()}),i.append(j)),j=$('<a href="relay.php?type=exportOMIMTermsAndSendBack&regiontype='+currentState.exploreRegionSelected+
"&query="+f+'" target="_blank"> Export all </a>'),j=false,f=$("<tr></tr>"),f.append(i),e.append(f),i=autoCompleteCallbackOMIMterm,showInfoPlot("omimwords"));c[4]&&(f=$('<tr id="rangeFeatureAutocompleteSearch"></tr>'),b=$('<td><label style="float:left;">Search here:</label><input id="exampleAutocomplete" type="text" size="30" style="float:left;"/></td>'),c[0].startsWith("GENENAME:")&&(c=$('<div class="ui-icon ui-icon-play ui-icon-turnred selectGeneSymbol" style="float:left;"></div>'),b.append(c)),
f.append(b),c=$("<td></td>"),j&&c.append(j),f.append(c),e.prepend(f),$("#exampleAutocomplete").autocomplete({source:i,delay:400,minLength:0}));$("#rangeFeaturePlotMain").show()}
function addTermsSlider(a,b,c,e,f,d){var g=$("<div></div>");g.slider({range:true,min:a,max:b,values:[a,b],slide:function(a,b){(b.values[0]<10||b.values[0]>109)&&(b.values[1]<10||b.values[1]>109)&&$("#"+d).text("Show only the "+c.sum(b.values[0],b.values[1])+" "+getReadableFeatureText(e+b.values[0]+"--"+e+b.values[1]))}});$("#"+f).append(g)}
function updateOpenedFeatureRegionsList(a){$("#rangeFeaturePlotMain").children().remove();var b=$('<div id="rangeFeaturePlot"></div>');$("#rangeFeaturePlotMain").append(b);showInfoPlot("nodescription");b.append($('<div id="rangeFeaturePlotTable" style="float:left;"></div>'));var c=[],e=0,f=null;$.each(a[4],function(a){a=a.split("_");f==null&&(f=a);c.push(['<a href="'+("http://genome.ucsc.edu/cgi-bin/hgTracks?db="+settings.genome+"&position="+a[a.length-3]+"%3A"+a[a.length-2]+"-"+a[a.length-1])+'" target="_blank">UCSC</a>',
a[a.length-3],parseInt(a[a.length-2],10),parseInt(a[a.length-1],10)]);e+=1});var d=new google.visualization.DataTable;d.addColumn("string","URL");d.addColumn("string","chromosome");d.addColumn("number","start");d.addColumn("number","end");d.addRows(c);var g=new google.visualization.ChartWrapper({chartType:"Table",containerId:"rangeFeaturePlotTable",dataTable:d,options:{page:"enable",sortColumn:1,sortAscending:false,allowHtml:true,width:"500px"}});g.draw();var d=getQuery("::qq::","Eregion","main"),
h=currentState.exploreRegionSelected,i=$('<div id="exportLinksDiv"></div>');b.append(i);i.append($("<a href='relay.php?type=exportRegionsAndSendBack&exportType=URL&regiontype="+h+"&query="+d+"' target='_blank'>Export all</a><br/><br/>"));i.append($("<a href='relay.php?type=exportRegionsAndSendBack&exportType=TEXTFILE&regiontype="+h+"&query="+d+"' target='_blank'>Download as text file</a><br/><br/>"));var j;j="http://genome.ucsc.edu/cgi-bin/hgTracks?db="+settings.genome;j=j+"&position="+f[f.length-
3]+"%3A"+f[f.length-2]+"-"+f[f.length-1];j=j+"&hgt.customText="+encodeURIComponent("http://epiexplorer.mpi-inf.mpg.de/relay.php?type=exportRegionsAndSendBack&exportType=UCSC&regiontype="+h+"&query="+d);i.append($("<a href='"+j+"' target='_blank'>Export as custom track in UCSC Genome Browser</a><br/><br/>"));i.append($("<a href='relay.php?type=exportRegionsAndSendBack&exportType=GALAXY&regiontype="+h+"&query="+d+"' target='_blank'>Export to Galaxy</a><br/><br/>"));i.append($("<a href='relay.php?type=exportRegionsAndSendBack&exportType=HYPERBROWSER&regiontype="+
h+"&query="+d+"' target='_blank'>Export to the genomic hyperbrowser</a><br/><br/>"));e<200?b.append($("<p style='clear:both;'>Listing all "+e+" regions</p>")):b.append($("<p style='clear:both;'>Listing "+e+" regions out of "+a[2]+"</p>"));if(e>10){var l=$(' <a href="#" onclick="return false"> Show full table </a> ');l.click(function(){g.setOption("page",null);g.setOption("height","350px");g.draw();l.remove()});b.append(l)}$("#rangeFeaturePlotMain").show();$(".progress_image_feature").remove();$(".progress_image_feature_plot").remove()}
function updateOpenedFeatureTable(a,b){var c=b[0].replace(/OVERLAP/g,settings.overlap).replace(/TISSUE/g,settings.tissue);updateOpenedFeatureTableLines(a,c,b,true);$(".progress_image_feature").remove();$(".progress_image_feature_plot").remove()}
function updateOpenedFeatureTableLines(a,b,c,e){var e=e&&currentState.referenceQuery.genome!="",f=[],d={},g=[],h=[],i=b.charAt(0)=="-",j=parseInt($("#totalDocuments").text().replace(/,/g,""),10),l=$("#openedFeatureResults").siblings("input:hidden").length==4,k=[];e&&(referenceQuery=currentState.referenceQuery.query.replace(/BASEREFQUERY/g,b+"*"),answerQuery(currentState.referenceQuery.dataset,referenceQuery,1500,0,false,"",function(a){$.each(a[3],function(a,b){var c=parseInt(b,10);currentState.referenceQuery.values[a]=
c;k.push(a)})}));$.each(a[3],function(a){k.push(a)});k.sort();var m=null;$.each(k,function(c,k){if(m!=k){m=k;var q=0;a[3][k]!==void 0&&(q=a[3][k]);var t=0;e&&currentState.referenceQuery.values[k]!==void 0&&(t=currentState.referenceQuery.values[k]);var p;overlapLabels[k]!=void 0?p=b.charAt(0)=="-"?"without "+overlapLabels[k]:overlapLabels[k]:b.length>0&&k.startsWith(b)?(p=k.substr(b.length),p=p.length>0?p:getReadableFeatureText(k)):p=b.charAt(0)=="-"?k.startsWith(b.substr(1))?"without "+k.substr(b.length-
1):k:getReadableFeatureText(k);var r,u;i?(r=j-parseInt(q,10),e&&(u=currentState.referenceQuery.totalNumber-parseInt(t,10)),f[p]=[r,u]):(r=numberWithCommas(q),f[p]=[parseInt(q,10),t]);g.push(p);h.push(f[p]);var s=l?$('<tr class="listResults" style="width:100%;"><td align="left" title="Click to select only these regions">'+p+'</td><td align="right" title="Click to select only these regions">'+r+'</td><td class="zoomINAdvanced" title="See the full distribution ..."><span class="ui-icon ui-icon-zoomin ui-icon-turnred" style="float:right;"/></td></tr>'):
$('<tr class="listResults" style="width:100%;"><td class="ui-icon ui-icon-triangle-1-e" style="float:left;padding:0;" title=""></td><td align="left" title="Click to select only these regions">'+p+'</td><td align="right" title="Click to select only these regions">'+r+"</td></tr>");if(i)s.one("click",function(a){a.stopPropagation();addResultsRefinementAndUpdate("","-"+k,-1,true)}),$("#openedFeatureResults").prepend(s);else{if($("#openedFeatureResults").siblings("input:hidden").length==4){var v=function(){var a=
$("#openedFeatureResults").siblings("input:hidden");if(a.length==4){var b=a[3].value,c=a[2].value;$.each(k.split(":"),function(a,b){c=c.replace("POS"+a+"SOP",b)});$(".featureRangeOrRatioResults").remove();$('<tr><td COLSPAN="3"><div class="featureRangeOrRatioResults"></div></td></tr>').insertAfter(s);updateOpenedFeatureCore(b,currentState.exploreRegionSelected,getQuery(" ",c+"*","main"),100,0,"",[c,2,0])}};s.children(".zoomINAdvanced").click(function(a){a.stopPropagation();v()});d[p]=v}s.one("click",
function(a){a.stopPropagation();addResultsRefinementAndUpdate("",k,r,true)});$("#openedFeatureResults").append(s)}}});g.length>0?updateOpenedFeatureTablePlotGoogle(f,g,h,d,c,e):($("#rangeFeaturePlotMain").children().remove(),$("#rangeFeaturePlotMain").show(),$("#rangeFeaturePlotMain").append($('<table id="rangeFeaturePlotTable"><tr style="width:100%;"><td align="left">No regions fit this query</td><td></td></tr></table>')))}
function updateOpenedFeatureTablePlotGoogle(a,b,c,e,f,d){$("#rangeFeaturePlotMain").children().remove();$("#rangeFeaturePlotMain").show();showInfoPlot("overlaptable");$("#rangeFeaturePlotMain").append($('<table id="rangeFeaturePlotTable"><tr><td colspan="2"><div id="rangeFeaturePlot"></div></td></tr></table>'));f[0].search("OVERLAP")>-1&&($("#rangeFeaturePlotTable").append('<tr><td>Select overlap criterion:</td><td><select id="overlapSelect"><option value="Eoverlaps">Any overlap (at least 1bp)</option><option value="Eoverlaps10p">Medium overlap (at least 10%)</option><option value="Eoverlaps50p">Strong overlap (at least 50%)</option></select></td></tr>'),
$("#overlapSelect").val(settings.overlap));f[0].search("TISSUE")>-1&&($("#rangeFeaturePlotTable").append('<tr><td>Select tissue:</td><td><select id="tissueSelect"></select></td></tr>'),$.each(settings.defaultTissues,function(a,b){$("#tissueSelect").append($('<option value="'+b+'">'+getTissueDescription(b)+"</option>"))}),$("#tissueSelect").val(settings.tissue));var g,a={width:800,height:400,colors:["#FA9627","#999999"],legend:"top",hAxis:{maxAlternation:3,textStyle:{fontName:"Tahoma",fontSize:10},
showTextEvery:1},vAxis:{title:"Percent of overlapping regions",format:"#,###.##%"},chartArea:{left:60,width:740}};d?(g={cols:[{label:"Overlap",type:"string"},{label:"Current selection ("+numberWithCommas(currentState.totalNumberOfRegions)+")",type:"number"},{label:"Reference ("+numberWithCommas(currentState.referenceQuery.totalNumber)+")",type:"number"}],rows:[]},$.each(b,function(a,b){g.rows.push({c:[{v:b,f:b},{v:c[a][0]/currentState.totalNumberOfRegions,f:c[a][0]+""},{v:c[a][1]/currentState.referenceQuery.totalNumber,
f:c[a][1]+""}]})})):(g={cols:[{label:"Overlap",type:"string"},{label:"Current selection ("+numberWithCommas(currentState.totalNumberOfRegions)+")",type:"number"}],rows:[]},$.each(b,function(a,b){g.rows.push({c:[{v:b,f:b},{v:c[a][0]/currentState.totalNumberOfRegions,f:c[a][0]+""}]})}),a.legend="none");var h=new google.visualization.DataTable(g,0.6),d="";b.length>1?(chartType="ColumnChart",d="table"):(chartType="Table",a.height=null,d="chart");var i=new google.visualization.ChartWrapper({chartType:chartType,
containerId:"rangeFeaturePlot",dataTable:h,options:a});i.draw();google.visualization.events.addListener(i,"select",function(){for(var a=i.getChart().getSelection(),b=0;b<a.length;b++){var c=a[b];if(c.row!=null&&c.column!=null){if(e[h.getValue(c.row,0)]!==void 0)e[h.getValue(c.row,0)]()}else if(c.row!=null&&e[h.getValue(c.row,0)]!==void 0)e[h.getValue(c.row,0)]()}});b=$('<tr class="showTableLink"><td colspan="2"><a href="#" onclick="return false">Show as '+d+"</a></td></tr>");b.click(function(){i.getChartType()==
"Table"?(i.setChartType("ColumnChart"),i.setOption("height",400),$(".showTableLink a").text("Show as table"),$("tr.toPNGRow").show()):(i.setChartType("Table"),i.setOption("height",null),$(".showTableLink a").text("Show as chart"),$("tr.toPNGRow").hide());i.draw()});$(".showTableLink").remove();$("#rangeFeaturePlotTable").append(b);$("tr.toPNGRow").remove();b=$('<tr class="toPNGRow"><td class="toPNGButton"><a href="#" onclick="return false">To PNG</a><input type="hidden" value="'+a.width+'"/> <input type="hidden" value="'+
a.height+'"/><input type="hidden" value="'+i.getContainerId()+'"/></td></tr>');$("#rangeFeaturePlotTable").append(b)}function referenceSelect(a,b,c,e,f){currentState.referenceQuery.genome=a;currentState.referenceQuery.dataset=b;currentState.referenceQuery.editable=false;currentState.referenceQuery.queryParts=c;referenceUpdate(e,f)}
function referenceUpdate(a,b){currentState.referenceQuery.query=getQueryFromParts(" ","BASEREFQUERY",currentState.referenceQuery.queryParts);currentState.referenceQuery.values={};answerQuery(currentState.referenceQuery.dataset,currentState.referenceQuery.query.replace(/BASEREFQUERY/g,"Eregion"),0,0,b,"",function(b){currentState.referenceQuery.totalNumber=b[2];if(currentState.referenceQuery.totalNumber<=0)alert("The reference query must have some results"),currentState.referenceQuery=getDefaultReferenceState();
else{$("#referenceListing").show();$("#referenceListing").html("");var e=$("<p class='referencelistingParagraph' style='padding-left:"+settings.standardIdentation+"px;'></p>");e.append($("<div><i>Genome</i>: "+currentState.referenceQuery.genome+"</div>"));e.append($("<div><i>Regions</i>: "+currentState.datasetInfo[currentState.referenceQuery.dataset].officialName+" ("+numberWithCommas(currentState.referenceQuery.totalNumber)+")</div>"));$.each(currentState.referenceQuery.queryParts,function(a,b){e.append($("<div><span class='referencePrefixRaw'>"+
b+"</span><i>"+getReadableFeatureText(b)+"</i><span class='ui-icon ui-icon-closethick ui-icon-turnred referencelistingRefinementX' ></span></div>"))});$("#referenceListing").append(e);var b=$('<div class="activeSearchBox" style="margin-top:10px;"><b style="padding-left:'+settings.standardIdentation+'px;">Reference regions</b></div>'),f=$('<span title="Remove the reference" class="ui-icon ui-icon-closethick ui-icon-turnred" style="margin-right:5px;float:right;"></span>');f.click(function(){$("#referenceListing").hide();
$("#referenceListing").removeClass("pretty-hover");$("#referenceListing").html("");$("#currentLinkLocation").text("");currentState.referenceQuery=getDefaultReferenceState();currentState.exploreRegionSelected!=settings.defaultRegionSelected&&updateCurrentSelectionOverlapPlot(false)});b.append(f);var d=$('<span title="Show the reference text" class="ui-icon ui-icon-newwin ui-icon-turnred" style="margin-right:5px;float:left;"></span>'),g=$('<span title="Hide the reference text" class="ui-icon ui-icon-arrowthickstop-1-s ui-icon-turnred" style="margin-right:5px;float:left;"></span>');
d.click(function(){$(".referencelistingParagraph").show();d.hide();g.show()});b.prepend(d);d.hide();g.click(function(){$(".referencelistingParagraph").hide();d.show();g.hide()});b.prepend(g);var h=$('<span title="This reference is currently dynamic. Press here, if you want to keep it constant" class="ui-icon ui-icon-unlocked ui-icon-turnred" style="margin-right:5px;float:right;"></span>'),i=$('<span title="This reference is currently constant. Press here, if you want to make it dynamic" class="ui-icon ui-icon-locked ui-icon-turnred" style="margin-right:5px;float:right;"></span>');
h.click(function(){currentState.referenceQuery.editable=false;$(".referencelistingRefinementX").hide();h.hide();i.show()});b.append(h);i.click(function(){currentState.referenceQuery.editable=true;$(".referencelistingRefinementX").show();h.show();i.hide();d.click()});b.append(i);currentState.referenceQuery.editable==false?(h.hide(),$(".referencelistingRefinementX").hide()):(i.hide(),$(".referencelistingRefinementX").show());$("#referenceListing").prepend(b);$("#referenceListing").prepend("");f.mouseleave();
a&&updateCurrentSelectionOverlapPlot(true);$("#currentLinkLocation").text("")}})}
function addRegionSelectionToTheQueryListing(a,b,c){b=$('<table class="regionsListingTable" cellspacing="0"></table>');a=$('<tr class="queryRegions" title="'+a+'"><td><b><label id="totalDocuments" style="margin-right:5px;float:left;">'+numberWithCommas(currentState.totalNumberOfRegions)+'</label><span style="float:left;" class="queryRegionsRaw">'+a+"</span></b></td></tr>");a.append($("<td/>"));if(settings.allowRemoveRegionSelection){var e=$('<td title="Remove this selection and explore other regions"><span class="ui-icon ui-icon-closethick ui-icon-turnred"></span></td>');
e.one("click",activateMode_ExploreRegionSelection);a.append(e)}b.append(a);$(".regionsSelected").append(b);c&&highlightElement(a,1E3,2)}
function addRefinementToTheQueryListing(a,b){var c=a;a.length==0&&(c=getReadableFeatureText(b));c=="Unknown"&&(c=b);currentState.currentOverlaps=settings.defaultCurrentOverlaps;currentState.currentNeighborhood=settings.defaultCurrentOverlaps;$("#currentLinkLocation").text("");if($(".queryRefinementORButtonActive").length>0){var e=$(".queryRefinementORButtonActive");deactivateORClause(e,false);var f=e.parent().siblings("td.queryPrefixMainTD").children("span.queryPrefixRaw"),d=f.text()+"|"+b;f.text(d);
e=e.parent().siblings("td.queryPrefixMainTD").children("span.queryPrefixTitle");c=e.html()+" <b>OR</b> "+c;e.html(c);updateResultsAndDocuments(false,true)}else{var g=$('<tr class="queryPrexix" title="'+a+'"><td class="queryPrefixMainTD"><span class="queryPrefixRaw">'+b+'</span><span class="queryPrefixTitle">'+c+"</td></tr>"),c=$('<td title="Remove this refinement" ><span class="ui-icon ui-icon-closethick ui-icon-turnred"/></td>');c.one("click",function(){$("#rangeFeaturePlotMain").children().remove();
g.remove();currentState.currentOverlaps=settings.defaultCurrentOverlaps;currentState.currentNeighborhood=settings.defaultCurrentOverlaps;$("#currentLinkLocation").text("");closeOpenFeatureBox();updateCurrentSelectionOverlapPlot(false);updateResultsAndDocuments(false,true)});e=$('<td title="Add additional conditions for this refinement"><span class="ui-icon ui-icon-arrowthick-2-e-w ui-icon-turnred queryRefinementORButtonDeactive"/></td>');g.append(e);g.append(c);$("table.regionsListingTable").append(g);
currentState.referenceQuery.genome!=""&&currentState.referenceQuery.editable&&(currentState.referenceQuery.queryParts.push(b),referenceUpdate(false,false))}}
function activateORClause(a,b){$(".queryRefinementORButtonActive").each(function(){deactivateORClause($(this),false)});a.removeClass("ui-icon-arrowthick-2-e-w");a.removeClass("queryRefinementORButtonDeactive");a.addClass("ui-icon-cancel");a.addClass("queryRefinementORButtonActive");a.attr("title","Cancel the OR selection");var c=a.parent().siblings("td.queryPrefixMainTD").children("span.queryPrefixRaw");c.addClass("queryPrefixRawOR");c.removeClass("queryPrefixRaw");currentState.currentOverlaps=settings.defaultCurrentOverlaps;
currentState.currentNeighborhood=settings.defaultCurrentOverlaps;$("#currentLinkLocation").text("");b&&($(".featureBoxOpened").length>0?updateOpenFeature(false,true,true):(updateCurrentSelectionOverlapPlot(false),updateOpenFeature(false,false,true)))}
function deactivateORClause(a,b){a.removeClass("ui-icon-cancel");a.removeClass("queryRefinementORButtonActive");a.addClass("ui-icon-arrowthick-2-e-w");a.addClass("queryRefinementORButtonDeactive");a.attr("title","Add additional conditions for this refinement");var c=a.parent().siblings("td.queryPrefixMainTD").children("span.queryPrefixRawOR");c.addClass("queryPrefixRaw");c.removeClass("queryPrefixRawOR");currentState.currentOverlaps=settings.defaultCurrentOverlaps;currentState.currentNeighborhood=
settings.defaultCurrentOverlaps;$("#currentLinkLocation").text("");b&&($(".featureBoxOpened").length>0?updateOpenFeature(false,true,true):(updateCurrentSelectionOverlapPlot(false),updateOpenFeature(false,false,true)))}
function addResultsRefinementAndUpdate(a,b,c,e){(c==0||c=="0")&&alert("This refinement will lead to 0 remaining results!");$("#rangeFeaturePlotMain").children().remove();addRefinementToTheQueryListing(a,b,true);e&&(closeOpenFeatureBox(),updateCurrentSelectionOverlapPlot(false));c!=-1?(currentState.totalNumberOfRegions=parseInt(c.replace(/,/g,"")),$("#totalDocuments").text(numberWithCommas(currentState.totalNumberOfRegions))):updateResultsAndDocuments(false,true)}
function updateNumberOfDocuments(a){currentState.totalNumberOfRegions=parseInt(a[2]);$("#totalDocuments").text(numberWithCommas(currentState.totalNumberOfRegions))}function answerQuery(a,b,c,e,f,d,g){a!=""&&$.ajax({async:f,type:"GET",url:"relay.php",dataType:"json",data:"type=basequeryJSON&regiontype="+a+"&query="+b+"&ncompl="+c+"&nhits="+e+"&extraSettings="+d,success:function(a){g(a)}})}
function showInfoPlot(a){a=getTextForPlotDescription(a);a!=""?($(".infoboxMain").show(),$(".infoboxPlot").show(),hideIframe(),$(".infoboxPlot").html(""),$(".infoboxPlot").append("<p><b>Chart description:</b> "+a+"</p>")):$(".infoboxPlot").html("")}function showInfoFeature(a,b){b!=""&&($(".infoboxMain").show(),$(".infoboxFeature").html(""),$(".infoboxFeature").append("<p><b>Feature ("+a+"): </b>"+b+"</p>"))}
function loadDatasetInfo(a,b){currentState.datasetInfo[a]==void 0&&$.ajax({type:"GET",url:"relay.php",dataType:"json",async:b,data:"type=getDatasetInfo&datasetName="+a,success:function(b){currentState.datasetInfo[a]=b}})}
function showInfoRegionSet(a,b){currentState.exploreRegionSelected=a;loadDatasetInfo(a,false);var c=$("<p></p>"),e=$("<h3></h3>");e.text(currentState.datasetInfo[a].officialName+" ("+numberWithCommas(currentState.datasetInfo[a].numberOfRegions)+" regions)");c.append(e);e=currentState.datasetInfo[a].isDefault==false?$("<p>"+currentState.datasetInfo[a].description+'</p><p class="tutorialMode">You may share this dataset using its unique ID ('+a+")</p>"):$("<p>"+currentState.datasetInfo[a].description+
"</p>");c.append(e);currentState.datasetInfo[a].moreInfoLink&&(e=$('<a href="'+currentState.datasetInfo[a].moreInfoLink+'" target="_blank">Click here for more info</a>'),c.append(e));$(".infoboxMain").show();hideIframe();$(".infoboxRegions").html("");$(".infoboxRegions").append(c);b&&(c=$('<p class="regionSelectionLinkFromInfoBox"><img src="extras/media-playback-start.png" width="16px" height="16px"/><a href="#" onclick="return false;">Explore this region set</a></p>'),c.click(function(){$(this).remove();
currentState.exploreRegionSelected=a;currentState.totalNumberOfRegions=currentState.datasetInfo[currentState.exploreRegionSelected].numberOfRegions;activateMode_ExploreRegionChosen(false)}),$(".infoboxRegions").append(c))}
function featureOpenBox(){hideIframe();var a=$(this).children("h4")[0];closeOpenFeatureBox();$(this).unbind("click");$(this).addClass("featureBoxOpened");$(a).children(".ui-icon-search").addClass("ui-icon-circle-check");$(a).children(".ui-icon-search").removeClass("ui-icon-search");$(a).append($('<img name="progress_image_feature" src="extras/ajax-loader.gif" class="progress_image_feature" align="right"></img>'));$(".visualization").append($('<img name="progress_image_feature_plot" src="extras/ajax-loader-big.gif" class="progress_image_feature_plot" align="center"></img>'));
$(this).append($('<table id="openedFeatureResults" style="padding-left:'+(parseInt($(a).css("padding-left").slice(0,-2),10)+settings.standardIdentation)+'px;" cellspacing="0"></table>'));updateOpenFeature(false,true,false)}
function closeOpenFeatureBox(){hideIframe();currentState.featureCurrentVisualization="";$(".ui-icon-circle-check").not("#iconLegend .ui-icon-circle-check").addClass("ui-icon-search");$(".ui-icon-circle-check").not("#iconLegend .ui-icon-circle-check").removeClass("ui-icon-circle-check");$("#rangeFeaturePlotMain").hide();$("#openedFeatureResults tr").remove();$("#openedFeatureResults div.featureRangeOrRatioResults").remove();$("#openedFeatureResults").remove();$(".featureBoxOpened").one("click",featureOpenBox);
$(".featureBoxOpened").removeClass("featureBoxOpened")}
function featureOpenBranch(a,b){var c=$(a),e=c.parent();c.children(".ui-icon").removeClass("ui-icon-plusthick");c.children(".ui-icon").addClass("ui-icon-minusthick");c.children(".ui-icon").addClass("ui-icon-turnred");var f=false;if(b&&c.siblings("input.featureBranchOverlapPrefixes").length>0)currentState.overlapSelection=c.siblings("input.featureBranchOverlapPrefixes").val().split(","),f=true;if(b&&c.children("input.featureBranchName").length>0){var d=c.children("input.featureBranchName").val();if(f&&
currentState.featuresElements[d]!==void 0)currentState.featureCurrentVisualization=d,$("#currentLinkLocation").text("")}f==true&&updateCurrentSelectionOverlapPlot(false);e.addClass("featureBranchOpened");e.children().show();c.children(".ui-icon").one("click",featureCloseBranch)}
function featureCloseBranch(a){a.stopPropagation();a=$(this).parent().parent();a.removeClass("featureBranchOpened");a.children("div").hide();$(this).removeClass("ui-icon-minusthick");$(this).removeClass("ui-icon-turnred");$(this).addClass("ui-icon-plusthick");$(this).unbind("click")}
function activateMode_ExploreRegionChosen(a){initFeatures(true);$(".features").show();$("tr.reloadUserDatasetTD").hide();$(".activateUserDatasetSpan").text("");$(".regionsSelection").hide();addRegionSelectionToTheQueryListing(currentState.datasetInfo[currentState.exploreRegionSelected].officialName,currentState.exploreRegionSelected,a);$(".regionsSelected").show();$(".visualization").show();$(".menuSeparator").show();$("#rangeFeaturePlotMain").show();$(".infoboxMain").show();hideIframe();$("#exportMenu").show();
a&&updateCurrentSelectionOverlapPlot(false)}function visualizeMode_ExploreRegionSelection(){$(".queryRegions").remove();$(".queryPrexix").remove();$("table.regionsListingTable").remove();$(".features").hide();$(".regionsSelection").show();$(".regionsSelected").hide();$("#currentLinkLocation").text("");$("#rangeFeaturePlotMain").show();$(".visualization").show();$(".menuSeparator").hide();$(".infoboxDetail").html("");$(".infoboxMain").hide();$("#exportMenu").hide();closeOpenFeatureBox()}
function activateMode_ExploreRegionSelection(){currentState.exploreRegionSelected=settings.defaultRegionSelected;currentState.currentOverlaps=settings.defaultCurrentOverlaps;currentState.currentNeighborhood=settings.defaultCurrentOverlaps;$("#currentLinkLocation").text("");currentState.overlapSelection=settings.overlapSelection[settings.genome];currentState.featureCurrentVisualization="";visualizeMode_ExploreRegionSelection()}
function initRegionSets(){$("#regionsTable").html("");$.ajax({type:"GET",url:"relay.php",dataType:"json",data:"type=regiontypes&sourceType="+settings.sourceType+"&genome="+settings.genome,success:function(a){currentState.datasetInfo=a;var b=[];$.each(currentState.datasetInfo,function(a,c){b.push(c.officialName)});b.sort();b.reverse();$.each(currentState.datasetInfo,function(a,c){var e=jQuery.inArray(c.officialName,b);b[e]=a});var c=$("#regionsTable"),e=0;$.each(b,function(a,b){var a=b,b=currentState.datasetInfo[a],
g=$('<tr class="regionsButton regionsButtonHover" title="See more information"></tr>');g.append($('<input type="hidden" value="'+a+'"/>'));g.append($('<td align="left" class="regionsetInfoButton hoverChangeIcon" title="Show information about this region set"><img src="extras/dialog-information.png" class="selectDatasetIcon"></img><div class="selectDatasetText">Info</div></td>'));g.append($('<td class="regionsetSelectButton" align="left" title="Explore this dataset">'+b.officialName+"</td>"));g.append($('<td class="regionsetSelectButton" align="right" title="Explore this dataset">'+
numberWithCommas(b.numberOfRegions)+"</td>"));g.append($('<td align="center" class="regionsetSelectButton hoverChangeIcon" title="Explore this dataset"><img src="extras/media-playback-start.png" class="selectDatasetIcon"></img><div class="selectDatasetText">Select</div></td>'));c.prepend(g);e+=parseInt(b.numberOfRegions,10)});$.each(currentState.userDatasets,function(a,b){activateUserDatasetFunction(b,currentState.loadedUserDatasetFromLink==b,false,true)});currentState.totalNumberOfRegions=e}})}
function genomeChanged(){$("#genomeSelectLabel div.menuicontext").text("Genome ("+settings.genome+")");$.cookie("cgs:settings:genome",settings.genome,{expires:14});currentState.overlapSelection=settings.overlapSelection[settings.genome];currentState.featureCurrentVisualization="";if($.cookie("cgs:settings:userdatasets:"+settings.genome)){var a=$.cookie("cgs:settings:userdatasets:"+settings.genome).split(";");currentState.userDatasets=a[0].length>0?a:[]}else currentState.userDatasets=[],$.cookie("cgs:settings:userdatasets:"+
settings.genome,currentState.userDatasets.join(";"),{expires:30});initRegionSets();activateMode_ExploreRegionSelection()}
function initSettings(){$("#genomeSelectLabel div.menuicontext").text("Genome ("+settings.genome+")");$("body").delegate(".genomeSelect","click",function(){settings.genome=$(this).text();genomeChanged()});$("body").delegate("#overlapSelect","change",function(){settings.overlap=$("#overlapSelect option:selected").val();$.cookie("cgs:settings:overlap",settings.overlap,{expires:14});currentState.exploreRegionSelected!=settings.defaultRegionSelected&&($(".featureBoxOpened").size()==0?updateCurrentSelectionOverlapPlot(true):
updateOpenFeature(false,true,false))});$("body").delegate("#tissueSelect","change",function(){settings.tissue=$("#tissueSelect option:selected").val();$.cookie("cgs:settings:tissue",settings.tissue,{expires:14});$(".featureBoxOpened").size()==0?updateCurrentSelectionOverlapPlot(false):updateOpenFeature(false,true,false)})}function showExternalPageInIFrame(a){$("div.content").hide();$("#contentFrameID").attr("src",a);$("div.contentFrame").show()}
function hideIframe(){$("#contentFrameID").attr("src","");$("div.contentFrame").hide();$("div.content").show()}
function initStartingSettings(){var a=getParameterByName("analysisLink");activateMode_ExploreRegionSelection();currentState.loadedUserDatasetFromLink==""&&showExternalPageInIFrame("welcome.php");a!=null&&$.ajax({type:"GET",url:"relay.php",async:false,data:{type:"getLinkData",analysisLink:a},dataType:"json",success:function(a){if(a[0]!=settings.genome)settings.genome=a[0],genomeChanged();if(a[1]!="")currentState.exploreRegionSelected=a[1],currentState.datasetInfo[currentState.exploreRegionSelected]==
void 0&&loadDatasetInfo(currentState.exploreRegionSelected,false),currentState.datasetInfo[currentState.exploreRegionSelected].isDefault==false&&(jQuery.inArray(a[1],currentState.userDatasets)==-1?(currentState.datasetInfo[currentState.exploreRegionSelected]=void 0,activateUserDatasetFunction(a[1],false,false,true)):activateUserDatasetFunction(a[1],false,false,false)),showInfoRegionSet(currentState.exploreRegionSelected,false),currentState.totalNumberOfRegions=currentState.datasetInfo[currentState.exploreRegionSelected].numberOfRegions,
activateMode_ExploreRegionChosen(false),a[2]!=""&&$.each(a[2].split("::qq::"),function(a,b){addRefinementToTheQueryListing("",b,false)}),updateResultsAndDocuments(false,true);if(a[4]!=""&&a[5]!=""){currentState.datasetInfo[a[5]]==void 0&&loadDatasetInfo(a[5],false);currentState.datasetInfo[a[5]].isDefault==false&&(jQuery.inArray(a[5],currentState.userDatasets)==-1?activateUserDatasetFunction(a[5],false,false,true):activateUserDatasetFunction(a[5],false,false,false));var c=[];$.each(a[6].split("::qq::"),
function(a,b){b.startsWith("BASEREFQ")||c.push(b)});referenceSelect(a[4],a[5],c,false,false)}a[3]!=""&&currentState.featuresElements[a[3]]!==void 0?loadVisualizationByID(a[3]):updateCurrentSelectionOverlapPlot(true)}})}
function initExploreButtons(){$("body").delegate(".exploreDefaultDatasetsButton","click",activateMode_ExploreRegionSelection);$("div.regions").delegate("td.showReloadUserDatasetButton","click",function(){$("tr.reloadUserDatasetTD").is(":visible")?$("tr.reloadUserDatasetTD").hide():$("tr.reloadUserDatasetTD").show()});$("td.uploadNewDatasetButton").click(function(){showExternalPageInIFrame("upload.php")});$("body").delegate(".exportRegionsButton","click",function(){var a=getQuery("::qq::","Eregion",
"main");window.open("relay.php?type=exportRegionsAndSendBack&regiontype="+currentState.exploreRegionSelected+"&query="+a,"CGSExport","").focus()});$("body").delegate(".useAsReferenceButton","click",function(){$("#currentLinkLocation").text("");var a=[];$.each($("span.queryPrefixRaw"),function(b,c){a.push($(c).text())});referenceSelect(settings.genome,currentState.exploreRegionSelected,a,true,true)});$("body").delegate("td.toPNGButton","click",function(){var a=800,b=400,c=$(this).children("input:hidden");
if(c.length==3){if(a=c[0].value,b=c[1].value,containerID=c[2].value,(c=$("#"+containerID+" iframe").contents().find("body").html())&&c.length>0){var e=c.indexOf("<svg"),f=c.indexOf("</svg>"),c=c.substring(e,f+6);$("#"+containerID).children().remove();$("#"+containerID).append($('<canvas id="canvasPlot'+containerID+'" width="'+a+'px" height="'+b+'px"></canvas> '));canvg("canvasPlot"+containerID,c);$(this).children("a").hide()}}else alert("Error: wrong number of inputs")});$("body").delegate(".activateUserDataset",
"click",function(){var a=$("#userDatasetID").val().trim();jQuery.inArray(a,currentState.userDatasets)==-1?activateUserDatasetFunction(a,true,false,true):($(".activateUserDatasetSpan").show(),$(".activateUserDatasetSpan").text("The dataset is already active").fadeOut(2E3,function(){}));$("#userDatasetID").val("Paste here a dataset ID and press enter")});$("#toggleCheckBoxes").button().click(function(){$("#exportQueryDataForm").toggleCheckboxes(":not(#regionsCheckBox)")});$("#checkCheckBoxes").button().click(function(){$("#exportQueryDataForm").checkCheckboxes(":not(#regionsCheckBox)")});
$("#uncheckCheckBoxes").button().click(function(){$("#exportQueryDataForm").unCheckCheckboxes(":not(#regionsCheckBox)")});$("div.regions").delegate(".queryRefinementORButtonDeactive","click",function(){activateORClause($(this),true)});$("div.regions").delegate(".queryRefinementORButtonActive","click",function(){deactivateORClause($(this),true)});$("body").delegate(".showNext10Results","click",function(){});$("body").delegate(".selectGeneSymbol","click",function(){var a=$("#exampleAutocomplete").val().toUpperCase();
/^[0-9A-Za-z]+$/.test(a)?addResultsRefinementAndUpdate("Overlapping with genes described by the symbol '"+a+"*'","[Egn:*%23gS:"+a+"*%20Egn:*]",-1,true):alert("This field must not be empty and must contain only letters and numbers")});$("body").delegate(".referencelistingRefinementX","click",function(){if(currentState.referenceQuery.editable){currentState.referenceQuery.editable=false;$(this).parent().remove();var a=[];$("span.referencePrefixRaw").each(function(){a.push($(this).text())});currentState.referenceQuery.queryParts=
a;referenceUpdate(true,false)}});$("div.leftside").delegate("span.referencelistingRefinementX","mouseenter",function(){$(this).parent().addClass("pretty-hover")});$("div.leftside").delegate("span.referencelistingRefinementX","mouseleave",function(){$(this).parent().removeClass("pretty-hover")});$("#referenceListing").delegate("div.activeSearchBox span.ui-icon-closethick","mouseenter",function(){$(this).parent().parent().addClass("pretty-hover")});$("#referenceListing").delegate("div.activeSearchBox span.ui-icon-closethick",
"mouseleave",function(){$(this).parent().parent().removeClass("pretty-hover")});$("div.leftside").delegate("tr.queryRegions td span.ui-icon-closethick","mouseenter",function(){$(this).parent().parent().parent().addClass("pretty-hover")});$("div.leftside").delegate("tr.queryRegions td span.ui-icon-closethick","mouseleave",function(){$(this).parent().parent().parent().removeClass("pretty-hover")});$("div.leftside").delegate("tr.queryPrexix td span.ui-icon-closethick","mouseenter",function(){$(this).parent().parent().addClass("pretty-hover")});
$("div.leftside").delegate("tr.queryPrexix td span.ui-icon-closethick","mouseleave",function(){$(this).parent().parent().removeClass("pretty-hover")});$("body").delegate(".selectGeneName","click",function(){var a=$(this).parent().parent().children("td"),b=$(a[1]).text(),c="Overlapping with gene "+b;$(a[2]).text().length>0&&(c=c+" ("+$(a[2]).text()+")");addResultsRefinementAndUpdate(c,"Egn:"+b,-1,true)});$("body").delegate(".selectGOName","click",function(){var a=$(this).parent().parent().children("td"),
b=$(a[1]).text(),c="Overlapping with genes annotated with "+b;$(a[4]).text().length>0&&(c=c+" ("+$(a[4]).text()+")");addResultsRefinementAndUpdate(c,"gGO:"+b,-1,true)});$("body").delegate(".selectGOterm","click",function(){var a="[gGO:*%23"+$(this).find("input:hidden").val()+"%20gGO:*]",b=$(this).parent().parent().children("td"),b="Overlapping with genes annotated with GO described by '"+$(b[1]).text()+"'";addResultsRefinementAndUpdate(b,a,-1,true)});$("body").delegate(".selectOMIMName","click",function(){var a=
$(this).parent().parent().children("td"),b=$(a[1]).text().split(":")[1],c="Overlapping with genes annotated with "+b;$(a[4]).text().length>0&&(c=c+" ("+$(a[4]).text()+")");addResultsRefinementAndUpdate(c,"omimID:"+b,-1,true)});$("body").delegate(".selectOMIMterm","click",function(){var a="[omimID:*%23"+$(this).find("input:hidden").val()+"%20omimID:*]",b=$(this).parent().parent().children("td"),b="Overlapping with genes annotated with OMIM described by '"+$(b[1]).text()+"'";addResultsRefinementAndUpdate(b,
a,-1,true)});$("body").delegate(".getLinkButton","click",function(){if(currentState.exploreRegionSelected==settings.defaultRegionSelected)$("#currentLinkLocation").text("No dataset selected"),highlightElement($("#currentLinkLocation"),700,2);else{var a={type:"getLink",genome:currentState.genome,currentSelection:currentState.exploreRegionSelected,currentQuery:getQuery("::qq::","","main"),currentView:currentState.featureCurrentVisualization,rGenome:"",rSelection:"",rQuery:"",rNORegions:""};if(currentState.referenceQuery.genome!=
"")a.rGenome=currentState.referenceQuery.genome,a.rSelection=currentState.referenceQuery.dataset,a.rQuery=currentState.referenceQuery.query.replace(/ /g,"::qq::"),a.rNORegions=currentState.referenceQuery.totalNumber;$.ajax({type:"GET",url:"relay.php",data:a,dataType:"json",success:function(a){a[0]=="0"?(a="http://epiexplorer.mpi-inf.mpg.de/index.php?analysisLink="+a[1],$("#currentLinkLocation").html('<a href="'+a+'" target="_blank">'+a+"</a>")):$("#currentLinkLocation").text(a[1])}})}});$("#userDatasetID").keypress(function(a){a.which==
13&&$(".activateUserDataset").click()});$("#userDatasetID").attr("value","Paste here a dataset ID and press enter");$("#userDatasetID").focus(function(){$(this).addClass("active");$(this).attr("value")=="Paste here a dataset ID and press enter"&&$(this).attr("value","")});$("#userDatasetID").blur(function(){$(this).removeClass("active");$(this).attr("value")==""&&$(this).attr("value","Paste here a dataset ID and press enter")});$("#showWelcomePageInFrame").click(function(){showExternalPageInIFrame("welcome.php")});
$("#showAboutPageInFrame").click(function(){showExternalPageInIFrame("about_epiexplorer.php")});$("#showUploadPageInFrame").click(function(){showExternalPageInIFrame("uploadManagement.php")});$("#presentationModeSwitch").click(function(){$("div.leftside").is(":visible")?($("div.container span.ui-layout-resizer div.ui-layout-toggler").click(),$(this).html('<img src="extras/measure.png" class="menusubicon">Presentation mode Off')):($("div.container span.ui-layout-resizer div.ui-layout-toggler").click(),
$(this).html('<img src="extras/measure.png" class="menusubicon">Presentation mode On'))})}
function initEventDelegationRegionsTable(){$(".regions").delegate(".regionsButtonHover","mouseenter",function(){$(this).addClass("pretty-hover")});$(".regions").delegate(".regionsButtonHover","mouseleave",function(){$(this).removeClass("pretty-hover")});$("div.visualization").delegate("td div.ui-icon-play","mouseenter",function(){$(this).parent().parent().removeClass("google-visualization-table-tr-over");$(this).parent().parent().addClass("pretty-hover")});$("div.visualization").delegate("td div.ui-icon-play",
"mouseleave",function(){$(this).parent().parent().removeClass("pretty-hover")});$(".regions").delegate(".regionsetInfoButton","click",function(){var a=$(this).siblings("input:hidden")[0].value;currentState.currentOverlaps=settings.defaultCurrentOverlaps;currentState.currentNeighborhood=settings.defaultCurrentOverlaps;$("#currentLinkLocation").text("");showInfoRegionSet(a,currentState.exploreRegionSelected!=a);currentState.exploreRegionSelected=a;updateCurrentSelectionOverlapPlot(false)});$(".regions").delegate(".regionsetSelectButton",
"mouseenter",function(){$(this).parent().children("td.regionsetSelectButton").css("background-color","#F7E7D7")});$(".regions").delegate(".regionsetSelectButton","mouseleave",function(){$(this).parent().children("td.regionsetSelectButton").css("background-color",null)});$(".regions").delegate(".regionsetSelectButton","click",function(){var a=$(this).siblings("input:hidden")[0].value;currentState.exploreRegionSelected=a;currentState.currentOverlaps=settings.defaultCurrentOverlaps;currentState.currentNeighborhood=
settings.defaultCurrentOverlaps;$("#currentLinkLocation").text("");currentState.totalNumberOfRegions=currentState.datasetInfo[currentState.exploreRegionSelected].numberOfRegions;activateMode_ExploreRegionChosen(false);showInfoRegionSet(a,currentState.exploreRegionSelected!=a);updateCurrentSelectionOverlapPlot(false);$(".regionSelectionLinkFromInfoBox").remove()});$("body").delegate(".hoverChangeIcon","mouseenter",function(){var a=$(this).children("img")[0];$(a).attr("src",$(a).attr("src").split(".").join("-hover."))});
$("body").delegate(".hoverChangeIcon","mouseleave",function(){var a=$(this).children("img")[0];$(a).attr("src",$(a).attr("src").split("-hover.").join("."))})}function initEventDelegationFeatureListing(){$(".features").delegate(".featureHover","hover",function(){$(this).toggleClass("pretty-hover")});$("body").delegate("#openedFeatureResults tr.listResults","hover",function(){$(this).toggleClass("pretty-hover");$(this).toggleClass("ui-corner-all")})}
function addFeatureGroupsToParentElement(a,b,c,e){var f=$("<div></div>");f.addClass("featureBranch");f.addClass("featureBranchClosed");var d=getTextForFeatureGroup(a),d=$('<h4 class="featureBox ui-corner-all" style="padding-left:'+settings.standardIdentation*e+'px;">'+d+"</h4>");d.addClass("featureHover");f.append(d);d.prepend($('<div class="ui-icon ui-icon-plusthick" style="float:left;"></div>'));var g=$('<input type="hidden" class="featureBranchName" value="'+a+'"></input>');d.append(g);g=getOverlapSummaryForGroup(a);
g!=""&&(g=$('<input type="hidden" class="featureBranchOverlapPrefixes" value="'+g+'"></input>'),f.append(g));c.append(f);currentState.featuresElements[a]=d;var h=[];$.each(b,function(a){h.push([getGroupOrderElem(a),a])});h.sort();$.each(h,function(a,c){var d=c[1],g=b[d];d!="featureBox"?addFeatureGroupsToParentElement(d,g,f,e+1):addFeatureBoxesToParentElement(d,g,f,e+1)})}
function addFeatureBoxesToParentElement(a,b,c,e){var f=[];$.each(b,function(a,b){f.push([getGroupOrderElem(b[0]),a])});f.sort();$.each(f,function(a,f){var a=f[1],h=b[a],i=$("<div></div>");i.addClass("featureBox");i.addClass("featureBoxClosed");var j=getTextForFeaturePrefix(h[0]),j=$('<h4 class="featureBox ui-corner-all" style="padding-left:'+settings.standardIdentation*e+'px;">'+j+"</h4>");j.addClass("featureHover");if(e==0){var l=$('<input type="hidden" class="featureBoxName" value="'+h[0]+'"></input>');
j.append(l)}i.append(j);j.prepend($('<div class="ui-icon ui-icon-search" style="float:left;"></div>'));var k=getTypeForFeaturePrefix(h[0]);i.addClass(k);if(k=="featureText"||k=="featureRange"||k=="featureRatio"||k=="featureNeighborhood")j=$('<input type="hidden" value="'+h[0]+'"></input>'),l=$('<input type="hidden" value="'+k+'"></input>'),i.append(j),i.append(l),k=="featureText"&&h.length>1?(l=getTypeForFeaturePrefix(h[1]),j=$('<input type="hidden" value="'+h[1]+'"></input>'),l=$('<input type="hidden" value="'+
l+'"></input>'),i.append(j),i.append(l)):k=="featureRange"&&h.length==3?(j=$('<input type="hidden" value="'+h[1]+'"></input>'),l=$('<input type="hidden" value="'+h[2]+'"></input>'),i.append(j),i.append(l)):k=="featureRatio"&&h.length==3?(j=$('<input type="hidden" value="'+h[1]+'"></input>'),l=$('<input type="hidden" value="'+h[2]+'"></input>'),i.append(j),i.append(l)):k=="featureNeighborhood"&&h.length==3&&(j=$('<input type="hidden" value="'+h[1]+'"></input>'),l=$('<input type="hidden" value="'+h[2]+
'"></input>'),i.append(j),i.append(l));else if(k=="featureTable"){var m=[];h[0].startsWith("GENENAME:ENSEMBL")?m=["gene","Egn:*","gene"]:h[0].startsWith("GO:ALL")?m=["","gGO:*","GOterm gGONG:000--gGONG:999"]:h[0].startsWith("GO:TERMS")?m=["gGOd:*","gGO:*","GOterm"]:h[0].startsWith("OMIM:ALL")?m=["","omimID:*","omim gOMIMNG:00--gOMIMNG:99"]:h[0].startsWith("OMIM:TERMS")&&(m=["omimD:*","omimID:*","omim"]);var j=$('<input type="hidden" value="'+h[0]+'"></input>'),l=$('<input type="hidden" value="'+k+
'"></input>'),k=$('<input type="hidden" value="'+m[0]+'"></input>'),o=$('<input type="hidden" value="'+m[1]+'"></input>'),m=$('<input type="hidden" value="'+m[2]+'"></input>');i.append(j);i.append(l);i.append(k);i.append(o);i.append(m)}else k=="featureRegionsList"&&(j=$('<input type="hidden" value="Eregion"></input>'),l=$('<input type="hidden" value="'+k+'"></input>'),i.append(j),i.append(l));c.append(i);currentState.featuresElements[h[0]]=i})}
function processFeatureArray(a){currentState.featuresElements=null;currentState.featuresElements={};currentState.featureCurrentVisualization="";$(".features").children().remove();var b=$('<div id="featureListingTree"></div>');$(".features").append(b);var c=[];$.each(a,function(a){c.push([getGroupOrderElem(a),a])});c.sort();var e=true;$.each(c,function(c,d){var g=d[1],h=a[g];if(e&&d[0]>=40||d[0]==99)b.append($('<hr class="dottedlineTransparent"></hr>')),e=false;g!="featureBox"?addFeatureGroupsToParentElement(g,
h,b,0):addFeatureBoxesToParentElement(g,h,b,0)});$(".featureBranchClosed").children("div").hide();$(".featureBranchClosed > h4").click(function(){featureOpenBranch(this,true)});$(".featureBoxClosed").one("click",featureOpenBox)}
function initFeatures(a){currentState.datasetFeatures[currentState.exploreRegionSelected]!==void 0?a&&processFeatureArray(currentState.datasetFeatures[currentState.exploreRegionSelected]):$.ajax({type:"GET",url:"relay.php",async:false,dataType:"json",data:"type=getfeatures&regiontype="+currentState.exploreRegionSelected+"&genome="+settings.genome,success:function(b){currentState.datasetFeatures[currentState.exploreRegionSelected]=b;a&&processFeatureArray(b)}})}
function autoCompleteCallbackGOterm(a){a=a.term.toUpperCase();if(/^[0-9A-Za-z]*$/.test(a)){var a=["GO:TERMS:","gGOd:"+a+"*","gGO:*","GOterm",false],b=getQueryComplexJoin(" ","Eregion",a[1],a[2],a[3]);updateOpenedFeatureCore("featureTable",currentState.exploreRegionSelected,b,200,0,"",a)}else alert("This field allows only letters and numbers")}
function autoCompleteCallbackOMIMterm(a){a=a.term.toUpperCase();if(/^[0-9A-Za-z]*$/.test(a)){var a=["OMIM:TERMS:","omimD:"+a+"*","omimID:*","omim",false],b=getQueryComplexJoin(" ","Eregion",a[1],a[2],a[3]);updateOpenedFeatureCore("featureTable",currentState.exploreRegionSelected,b,200,0,"",a)}else alert("This field allows only letters and numbers")}
function autoCompleteCallbackGene(a){parts=["gene","Egn:*","gene"];a=a.term.toUpperCase();if(/^[0-9A-Za-z]*$/.test(a)){var a=["GENENAME:ENSEMBL:","gS:"+a+"* gene","Egn:*","gene",false],b=getQueryComplexJoin(" ","Eregion",a[1],a[2],a[3]);updateOpenedFeatureCore("featureTable",currentState.exploreRegionSelected,b,0,200,"",a)}else alert("This field allows only letters and numbers")}
function autoCompleteCallbackGOcategory(a){var a=a.term.toUpperCase().split(" "),b=[],c=/^[0-9A-Za-z]*$/;$.each(a,function(a,d){c.test(d)?b.push("gGOd:"+d+"*"):alert("This field allows only letters and numbers")});b.push("GOterm");var a=$("select.minGenesOFGO option:selected").val(),e=$("select.maxGenesOFGO option:selected").val();b.push("GOterm gGONG:"+a+"--gGONG:"+e);a=["GO:ALL:","","gGO:*",b.join(" "),false];e=getQueryComplexJoin(" ","Eregion",a[1],a[2],a[3]);updateOpenedFeatureCore("featureTable",
currentState.exploreRegionSelected,e,100,0,"rw=1d",a)}
function autoCompleteCallbackOMIMcategory(a){var a=a.term.toUpperCase().split(" "),b=[],c=/^[0-9A-Za-z]*$/;$.each(a,function(a,d){c.test(d)?b.push("omimD:"+d+"*"):alert("This field allows only letters and numbers")});b.push("omim");b.push("gOMIMNG:00--gOMIMNG:99");var a=["OMIM:ALL:","","omimID:*",b.join(" "),false],e=getQueryComplexJoin(" ","Eregion",a[1],a[2],a[3]);updateOpenedFeatureCore("featureTable",currentState.exploreRegionSelected,e,100,0,"rw=1d",a)}
function loadVisualizationByID(a){if(currentState.featuresElements[a]!==void 0){for(var b=currentState.featuresElements[a].parent(),c=[];b.hasClass("featureBranch");)b.hasClass("featureBranchOpened")||c.push(b),b=b.parent();$.each(c.reverse(),function(a,b){featureOpenBranch(b.children("h4.featureBox"),false)});$(currentState.featuresElements[a]).click()}};